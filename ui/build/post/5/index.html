<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link href="/favicon.ico" rel="icon"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="#000000" name="theme-color"><link href="/logo192.png" rel="apple-touch-icon"><link href="/manifest.json" rel="manifest"><title>Arthur Dayton Blog Site</title><link href="/static/css/main.0d183a93.chunk.css" rel="stylesheet"><style data-emotion="css">.css-vurnku{box-sizing:border-box;margin:0;min-width:0}.css-oxi7wx{box-sizing:border-box;margin:0;min-width:0;padding-bottom:8px}@media screen and (min-width:40em){.css-oxi7wx{padding-bottom:8px}}@media screen and (min-width:52em){.css-oxi7wx{padding-bottom:32px}}.css-1o61k66{box-sizing:border-box;margin:0;min-width:0;background-color:#000;-webkit-box-align:center;align-items:center;display:flex}.css-ozbgqc{box-sizing:border-box;margin:0;min-width:0;max-width:100%;width:54.4px;height:37px;border-radius:0;display:none}@media screen and (min-width:40em){.css-ozbgqc{width:108.8px;height:74px}}@media screen and (min-width:52em){.css-ozbgqc{width:136px;height:92.5px}}@media screen and (min-width:40em){.css-ozbgqc{display:block}}@media screen and (min-width:52em){.css-ozbgqc{display:block}}.css-1nqru1l{box-sizing:border-box;margin:0;min-width:0;color:#e9ecf5;font-weight:700;font-size:1.5em;text-decoration:none;padding:4px;display:none}@media screen and (min-width:40em){.css-1nqru1l{padding:16px}}@media screen and (min-width:52em){.css-1nqru1l{padding:16px}}.css-1nqru1l:hover{color:#ccd6eb;font-weight:900}@media screen and (min-width:40em){.css-1nqru1l{display:block}}@media screen and (min-width:52em){.css-1nqru1l{display:block}}.css-1ntkiwo{box-sizing:border-box;margin:0 auto;min-width:0}.css-hrpk47{box-sizing:border-box;margin:0;min-width:0;color:#e9ecf5;font-weight:700;text-decoration:none;padding:4px 32px 4px 4px;display:block;font-size:20px}@media screen and (min-width:40em){.css-hrpk47{padding:16px}}@media screen and (min-width:52em){.css-hrpk47{padding:16px}}.css-hrpk47:hover{color:#ccd6eb;font-weight:900}@media screen and (min-width:40em){.css-hrpk47{display:none;font-size:24px}}@media screen and (min-width:52em){.css-hrpk47{display:none;font-size:24px}}.css-1co1q8w{box-sizing:border-box;margin:0;min-width:0;background-color:#ccd6eb;display:none}.css-1wc86sm{box-sizing:border-box;margin:0;min-width:0;flex-wrap:wrap;text-align:right;display:flex}.css-npj7sz{box-sizing:border-box;margin:0;min-width:0;width:100%;padding:8px}.css-10yqanw{box-sizing:border-box;margin:0;min-width:0;color:#566db3;font-weight:700;font-size:1em;text-decoration:none;padding:16px}.css-10yqanw:hover{color:#ccd6eb;font-weight:900}.css-7um157{box-sizing:border-box;margin:0;min-width:0;height:37px}@media screen and (min-width:40em){.css-7um157{height:74px}}@media screen and (min-width:52em){.css-7um157{height:92.5px}}.css-1u6ks9t{box-sizing:border-box;margin:0;min-width:0;padding-left:8px}@media screen and (min-width:40em){.css-1u6ks9t{padding-left:8px}}@media screen and (min-width:52em){.css-1u6ks9t{padding-left:32px}}.css-93hpa0{box-sizing:border-box;margin:0;min-width:0;padding:0;font-family:arial}@media screen and (min-width:40em){.css-93hpa0{padding:8px}}@media screen and (min-width:52em){.css-93hpa0{padding:32px}}.css-1vzt88e{box-sizing:border-box;margin:0;min-width:0;padding-left:0;padding-top:0;padding-bottom:0}@media screen and (min-width:40em){.css-1vzt88e{padding-left:8px;padding-top:8px;padding-bottom:8px}}@media screen and (min-width:52em){.css-1vzt88e{padding-left:32px;padding-top:32px;padding-bottom:32px}}.css-yz2fnm{box-sizing:border-box;margin:0;min-width:0;font-size:24px;color:#000;font-family:Arial,sans-serif}.css-1bo66fg{box-sizing:border-box;margin:0;min-width:0;color:#000;font-family:Arial,sans-serif;font-size:.75em;padding-left:8px;padding-top:8px}.css-18ybmw{box-sizing:border-box;margin:0;min-width:0;color:#000;font-family:Arial,sans-serif;font-size:.75em;padding-left:8px}.css-4ax88y{box-sizing:border-box;margin:0;min-width:0;color:#000;font-family:Arial,sans-serif;font-size:.75em;padding-left:8px;padding-bottom:8px}.css-1ucrkln{box-sizing:border-box;margin:0;min-width:0;padding-top:8px;padding-left:0}@media screen and (min-width:40em){.css-1ucrkln{padding-left:8px}}@media screen and (min-width:52em){.css-1ucrkln{padding-left:32px}}.css-iyq5fi{box-sizing:border-box;margin:0;min-width:0;padding-left:0;padding-top:8px;padding-bottom:8px}@media screen and (min-width:40em){.css-iyq5fi{padding-left:8px}}@media screen and (min-width:52em){.css-iyq5fi{padding-left:16px}}.css-1lyp5n8{box-sizing:border-box;margin:8px 0;min-width:0}@media screen and (min-width:40em){.css-1lyp5n8{margin-left:8px}}@media screen and (min-width:52em){.css-1lyp5n8{margin-left:32px}}.css-1uzs5fn{box-sizing:border-box;margin:0;min-width:0;padding-top:0;padding-bottom:0;padding-left:0;font-size:.75em}@media screen and (min-width:40em){.css-1uzs5fn{padding-top:8px;padding-bottom:8px;padding-left:8px;font-size:1.5em}}@media screen and (min-width:52em){.css-1uzs5fn{padding-top:32px;padding-bottom:32px;padding-left:16px;font-size:1.5em}}.css-qjyand{box-sizing:border-box;margin:0;min-width:0;font-size:24px;font-family:heading}</style><script src="/static/js/156.1326124f.chunk.js" charset="utf-8"></script><meta content="Arthur Dayton" data-react-helmet="true" property="article:author"><meta content="2022-02-16" data-react-helmet="true" property="article:published_time"><script src="/static/js/154.730b755d.chunk.js" charset="utf-8"></script><script src="/static/js/react-syntax-highlighter_languages_refractor_json.4e8e5b51.chunk.js" charset="utf-8"></script><meta content="article" data-react-helmet="true" property="og:type"><meta content="The magic of Infrastructure as Code with Terraform" data-react-helmet="true" property="og:title" name="title"><meta content="https://arthurdayton.com/post/5/" data-react-helmet="true" property="og:url"><meta content="%PUBLIC_URL%/images/5/preview.png" data-react-helmet="true" property="og:image" name="image"><meta content="This post shows hows to use maps and for-each loops with Terraform to dynamically create infrastructure on AWS" data-react-helmet="true" property="og:description" name="description"><meta content="2022-02-16" data-react-helmet="true" property="article:published_date"><meta content="Terraform" data-react-helmet="true" property="article:tag"><meta content="AWS" data-react-helmet="true" property="article:tag"><meta content="Docker" data-react-helmet="true" property="article:tag"><meta content="VPC" data-react-helmet="true" property="article:tag"><meta content="Terraform maps" data-react-helmet="true" property="article:tag"><meta content="Terraform for each" data-react-helmet="true" property="article:tag"><meta content="EC2" data-react-helmet="true" property="article:tag"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="css-vurnku" style="position:fixed;width:100%"><div class="css-oxi7wx"><div class="css-1o61k66"><img class="css-ozbgqc" src="/static/media/ObservatoryPark.ba50a4b1.jpg"><a href="/blog" class="css-1nqru1l">Blog</a><a href="/about" class="css-1nqru1l">About</a><a class="css-1nqru1l" id="logOnButton">LogIn</a><div class="css-1ntkiwo"></div><div class="css-hrpk47"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 448 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></div></div><div class="css-1co1q8w"><div class="css-1wc86sm"><div class="css-npj7sz"><a href="/blog" class="css-10yqanw">Blog</a></div><div class="css-npj7sz"><a href="/about" class="css-10yqanw">About</a></div></div></div></div></div><div class="css-7um157"></div><div class="css-1u6ks9t"><div class="css-vurnku" id="post_page_parent_5"><div class="css-93hpa0"><div class="css-1vzt88e"><h1 class="css-yz2fnm">The magic of Infrastructure as Code with Terraform</h1><h5 class="css-1bo66fg"><div class="css-vurnku">Tech: Docker - Terraform - AWS</div></h5><h5 class="css-18ybmw">Posted: 2021-03-29</h5><h5 class="css-4ax88y">Last Updated: 021-03-29</h5></div><div class="css-1ucrkln"><div><div class="css-iyq5fi"><h4 class="css-yz2fnm">Using maps and for-each to kick it up a notch</h4></div><div class="css-1lyp5n8">Infrastructure as code is the standard for cloud development that all companies are trying to achieve. <a href="https://dzone.com/articles/the-top-7-infrastructure-as-code-tools-for-automat" target="_blank">Lots of tools exist</a> but I'm a big fan of Terraform, especially over learning cloud vendor specific tools like Cloud Formation or ARM, because of the ease with which I can do similar things on different clouds, state management with <a href="https://www.terraform.io/cloud" target="_blank">Terraform Cloud</a> and their ever expanding <a href="https://registry.terraform.io/browse/providers" target="_blank">list of providers</a>. Deploying single stand alone resources is easy and for a lot of scenarios that's fine but what happens when we have more complex scenarios where we need to deploy multiple types of resources that have interdependencies, different lifecycles and n number of instances? This is where infrastructure as code becomes more like development then configuration and the power of maps and loops in Terraform shines.</div><br><div class="css-1lyp5n8"><a href="https://www.terraform.io/docs/language/expressions/types.html" target="_blank" pl="2">Terraform types </a>include maps which allow us to define hierarchical objects which we can iterate over and output to be used by other processes. The scenario I need to accommodate is creating multiple peered VPCs, subnets and compute instances. The number of all is arbitrary and I need to be able to iterate the results of the creation of my VPCs to create the subnets and EC2 instances.</div><br><div class="css-1lyp5n8"><a href="https://github.com/arthurdayton116/aws-terraform/tree/main/peering/terraform_vpc_peering" target="_blank" p="4">Code located here</a></div><br><div class="css-1lyp5n8">I will start by using a local variable to define the configuration of my VPCs</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">locals <span class="token punctuation">{</span> vpc_values = <span class="token punctuation">{</span> a = <span class="token punctuation">{</span> name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-vpc"</span><span class="token punctuation">,</span> cidr_vpc = <span class="token" style="color:#f1fa8c">"10.1.0.0/16"</span><span class="token punctuation">,</span> region = local.region security_group_ingress_cidr = <span class="token punctuation">[</span><span class="token" style="color:#f1fa8c">"10.1.0.0/16"</span><span class="token punctuation">,</span> <span class="token" style="color:#f1fa8c">"10.2.0.0/16"</span><span class="token punctuation">]</span> peer_cidr = <span class="token" style="color:#f1fa8c">"10.2.0.0/16"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> b = <span class="token punctuation">{</span> name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-vpc"</span><span class="token punctuation">,</span> cidr_vpc = <span class="token" style="color:#f1fa8c">"10.2.0.0/16"</span><span class="token punctuation">,</span> region = local.region<span class="token punctuation">,</span> security_group_ingress_cidr = <span class="token punctuation">[</span><span class="token" style="color:#f1fa8c">"10.1.0.0/16"</span><span class="token punctuation">,</span> <span class="token" style="color:#f1fa8c">"10.2.0.0/16"</span><span class="token punctuation">]</span> peer_cidr = <span class="token" style="color:#f1fa8c">"10.1.0.0/16"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">Looking at the vpc_values we see values for two VPCs, a and b, with cidr ranges for the vpc and ranges for defining peering realationships and security groups.</div><div class="css-1lyp5n8">There are two approaches, count and for_each, to create multiple instances of resources with Terraform. When to use one or the other is described <a href="https://www.terraform.io/docs/language/meta-arguments/count.html#when-to-use-for_each-instead-of-count" target="_blank">here.</a></div><div class="css-1lyp5n8">To create VPCs from these values we use a <a href="https://www.terraform.io/docs/language/meta-arguments/for_each.html" target="_blank">for_each</a> loop:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">resource <span class="token" style="color:#f1fa8c">"aws_vpc"</span> <span class="token" style="color:#f1fa8c">"vpc"</span> <span class="token punctuation">{</span> for_each = local.vpc_values cidr_block = each.value.cidr_vpc instance_tenancy = <span class="token" style="color:#f1fa8c">"default"</span> enable_dns_support = <span class="token boolean">true</span> enable_dns_hostnames = <span class="token boolean">true</span> <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">We pass the local variable to a resource definition and then can reference the values within the object using the each property. This allows us to use one resource definition to create an arbitrary number of resources. We can reference our vpc resource definition in other resources, again using the for_each property, like I do here with internet gateway resource to access the VPC id (each.value.id) and the vpc keys (each.key):</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">resource <span class="token" style="color:#f1fa8c">"aws_internet_gateway"</span> <span class="token" style="color:#f1fa8c">"i"</span> <span class="token punctuation">{</span> for_each = aws_vpc.vpc vpc_id = each.value.id tags = merge( local.base_tags<span class="token punctuation">,</span> <span class="token punctuation">{</span> Name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-vpc${each.key}-igw"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> ) <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">We can use the <a href="https://www.terraform.io/docs/language/expressions/for.html" target="_blank">for</a> expression in our outputs to create maps of values to reference in other terrafom projects downstream:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25 </span><span class="react-syntax-highlighter-line-number">26 </span><span class="react-syntax-highlighter-line-number">27</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">output <span class="token" style="color:#f1fa8c">"vpc_ids"</span> <span class="token punctuation">{</span> value = <span class="token punctuation">{</span> for k<span class="token punctuation">,</span> vpc in aws_vpc.vpc <span class="token operator">:</span> k => vpc.id <span class="token punctuation">}</span> <span class="token punctuation">}</span> output <span class="token" style="color:#f1fa8c">"vpc_info"</span> <span class="token punctuation">{</span> value = <span class="token punctuation">{</span> for k<span class="token punctuation">,</span> vpc in aws_vpc.vpc <span class="token operator">:</span> k => vpc <span class="token punctuation">}</span> <span class="token punctuation">}</span> output <span class="token" style="color:#f1fa8c">"vpc_config"</span> <span class="token punctuation">{</span> value = <span class="token punctuation">{</span> for k<span class="token punctuation">,</span> vpc in local.vpc_values <span class="token operator">:</span> k => vpc <span class="token punctuation">}</span> <span class="token punctuation">}</span> output <span class="token" style="color:#f1fa8c">"igw_ids"</span> <span class="token punctuation">{</span> value = <span class="token punctuation">{</span> for k<span class="token punctuation">,</span> igw in aws_internet_gateway.i <span class="token operator">:</span> k => igw.id <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">produces:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25 </span><span class="react-syntax-highlighter-line-number">26 </span><span class="react-syntax-highlighter-line-number">27 </span><span class="react-syntax-highlighter-line-number">28 </span><span class="react-syntax-highlighter-line-number">29 </span><span class="react-syntax-highlighter-line-number">30 </span><span class="react-syntax-highlighter-line-number">31 </span><span class="react-syntax-highlighter-line-number">32 </span><span class="react-syntax-highlighter-line-number">33 </span><span class="react-syntax-highlighter-line-number">34 </span><span class="react-syntax-highlighter-line-number">35 </span><span class="react-syntax-highlighter-line-number">36 </span><span class="react-syntax-highlighter-line-number">37 </span><span class="react-syntax-highlighter-line-number">38 </span><span class="react-syntax-highlighter-line-number">39 </span><span class="react-syntax-highlighter-line-number">40 </span><span class="react-syntax-highlighter-line-number">41 </span><span class="react-syntax-highlighter-line-number">42 </span><span class="react-syntax-highlighter-line-number">43 </span><span class="react-syntax-highlighter-line-number">44 </span><span class="react-syntax-highlighter-line-number">45 </span><span class="react-syntax-highlighter-line-number">46 </span><span class="react-syntax-highlighter-line-number">47 </span><span class="react-syntax-highlighter-line-number">48 </span><span class="react-syntax-highlighter-line-number">49 </span><span class="react-syntax-highlighter-line-number">50 </span><span class="react-syntax-highlighter-line-number">51 </span><span class="react-syntax-highlighter-line-number">52 </span><span class="react-syntax-highlighter-line-number">53 </span><span class="react-syntax-highlighter-line-number">54 </span><span class="react-syntax-highlighter-line-number">55 </span><span class="react-syntax-highlighter-line-number">56 </span><span class="react-syntax-highlighter-line-number">57 </span><span class="react-syntax-highlighter-line-number">58 </span><span class="react-syntax-highlighter-line-number">59 </span><span class="react-syntax-highlighter-line-number">60 </span><span class="react-syntax-highlighter-line-number">61 </span><span class="react-syntax-highlighter-line-number">62 </span><span class="react-syntax-highlighter-line-number">63 </span><span class="react-syntax-highlighter-line-number">64 </span><span class="react-syntax-highlighter-line-number">65 </span><span class="react-syntax-highlighter-line-number">66 </span><span class="react-syntax-highlighter-line-number">67 </span><span class="react-syntax-highlighter-line-number">68 </span><span class="react-syntax-highlighter-line-number">69 </span><span class="react-syntax-highlighter-line-number">70 </span><span class="react-syntax-highlighter-line-number">71 </span><span class="react-syntax-highlighter-line-number">72 </span><span class="react-syntax-highlighter-line-number">73 </span><span class="react-syntax-highlighter-line-number">74 </span><span class="react-syntax-highlighter-line-number">75 </span><span class="react-syntax-highlighter-line-number">76 </span><span class="react-syntax-highlighter-line-number">77 </span><span class="react-syntax-highlighter-line-number">78 </span><span class="react-syntax-highlighter-line-number">79 </span><span class="react-syntax-highlighter-line-number">80 </span><span class="react-syntax-highlighter-line-number">81 </span><span class="react-syntax-highlighter-line-number">82 </span><span class="react-syntax-highlighter-line-number">83 </span><span class="react-syntax-highlighter-line-number">84 </span><span class="react-syntax-highlighter-line-number">85 </span><span class="react-syntax-highlighter-line-number">86 </span><span class="react-syntax-highlighter-line-number">87 </span><span class="react-syntax-highlighter-line-number">88 </span><span class="react-syntax-highlighter-line-number">89</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">vpc_ids = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"a"</span> = <span class="token" style="color:#f1fa8c">"vpc-01e64fe235cb0c529"</span> <span class="token" style="color:#f1fa8c">"b"</span> = <span class="token" style="color:#f1fa8c">"vpc-079dd05c64c0a3ebe"</span> <span class="token punctuation">}</span> vpc_info = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"a"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"arn"</span> = <span class="token" style="color:#f1fa8c">"arn:aws:ec2:us-west-2:793219755011:vpc/vpc-01e64fe235cb0c529"</span> <span class="token" style="color:#f1fa8c">"assign_generated_ipv6_cidr_block"</span> = <span class="token boolean">false</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.1.0.0/16"</span> <span class="token" style="color:#f1fa8c">"default_network_acl_id"</span> = <span class="token" style="color:#f1fa8c">"acl-015de4d9c963111ab"</span> <span class="token" style="color:#f1fa8c">"default_route_table_id"</span> = <span class="token" style="color:#f1fa8c">"rtb-0317b663263959e41"</span> <span class="token" style="color:#f1fa8c">"default_security_group_id"</span> = <span class="token" style="color:#f1fa8c">"sg-0806180aa07a0b29a"</span> <span class="token" style="color:#f1fa8c">"dhcp_options_id"</span> = <span class="token" style="color:#f1fa8c">"dopt-7754a212"</span> <span class="token" style="color:#f1fa8c">"enable_classiclink"</span> = <span class="token boolean">false</span> <span class="token" style="color:#f1fa8c">"enable_classiclink_dns_support"</span> = <span class="token boolean">false</span> <span class="token" style="color:#f1fa8c">"enable_dns_hostnames"</span> = <span class="token boolean">true</span> <span class="token" style="color:#f1fa8c">"enable_dns_support"</span> = <span class="token boolean">true</span> <span class="token" style="color:#f1fa8c">"id"</span> = <span class="token" style="color:#f1fa8c">"vpc-01e64fe235cb0c529"</span> <span class="token" style="color:#f1fa8c">"instance_tenancy"</span> = <span class="token" style="color:#f1fa8c">"default"</span> <span class="token" style="color:#f1fa8c">"ipv6_association_id"</span> = <span class="token" style="color:#f1fa8c">""</span> <span class="token" style="color:#f1fa8c">"ipv6_cidr_block"</span> = <span class="token" style="color:#f1fa8c">""</span> <span class="token" style="color:#f1fa8c">"main_route_table_id"</span> = <span class="token" style="color:#f1fa8c">"rtb-0317b663263959e41"</span> <span class="token" style="color:#f1fa8c">"owner_id"</span> = <span class="token" style="color:#f1fa8c">"793219755011"</span> <span class="token" style="color:#f1fa8c">"tags"</span> = tomap(<span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"Name"</span> = <span class="token" style="color:#f1fa8c">"sample-company-vpc-a"</span> <span class="token" style="color:#f1fa8c">"billTo"</span> = <span class="token" style="color:#f1fa8c">"study"</span> <span class="token" style="color:#f1fa8c">"createdBy"</span> = <span class="token" style="color:#f1fa8c">"terraform"</span> <span class="token" style="color:#f1fa8c">"directory"</span> = <span class="token" style="color:#f1fa8c">"peering/terraform_vpc_peering"</span> <span class="token" style="color:#f1fa8c">"environment"</span> = <span class="token" style="color:#f1fa8c">"production"</span> <span class="token" style="color:#f1fa8c">"owner"</span> = <span class="token" style="color:#f1fa8c">"Sample Company"</span> <span class="token punctuation">}</span>) <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"b"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"arn"</span> = <span class="token" style="color:#f1fa8c">"arn:aws:ec2:us-west-2:793219755011:vpc/vpc-079dd05c64c0a3ebe"</span> <span class="token" style="color:#f1fa8c">"assign_generated_ipv6_cidr_block"</span> = <span class="token boolean">false</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.2.0.0/16"</span> <span class="token" style="color:#f1fa8c">"default_network_acl_id"</span> = <span class="token" style="color:#f1fa8c">"acl-037ba106a3cc0cc8e"</span> <span class="token" style="color:#f1fa8c">"default_route_table_id"</span> = <span class="token" style="color:#f1fa8c">"rtb-0972dfffc68a8f736"</span> <span class="token" style="color:#f1fa8c">"default_security_group_id"</span> = <span class="token" style="color:#f1fa8c">"sg-0858668e97965b657"</span> <span class="token" style="color:#f1fa8c">"dhcp_options_id"</span> = <span class="token" style="color:#f1fa8c">"dopt-7754a212"</span> <span class="token" style="color:#f1fa8c">"enable_classiclink"</span> = <span class="token boolean">false</span> <span class="token" style="color:#f1fa8c">"enable_classiclink_dns_support"</span> = <span class="token boolean">false</span> <span class="token" style="color:#f1fa8c">"enable_dns_hostnames"</span> = <span class="token boolean">true</span> <span class="token" style="color:#f1fa8c">"enable_dns_support"</span> = <span class="token boolean">true</span> <span class="token" style="color:#f1fa8c">"id"</span> = <span class="token" style="color:#f1fa8c">"vpc-079dd05c64c0a3ebe"</span> <span class="token" style="color:#f1fa8c">"instance_tenancy"</span> = <span class="token" style="color:#f1fa8c">"default"</span> <span class="token" style="color:#f1fa8c">"ipv6_association_id"</span> = <span class="token" style="color:#f1fa8c">""</span> <span class="token" style="color:#f1fa8c">"ipv6_cidr_block"</span> = <span class="token" style="color:#f1fa8c">""</span> <span class="token" style="color:#f1fa8c">"main_route_table_id"</span> = <span class="token" style="color:#f1fa8c">"rtb-0972dfffc68a8f736"</span> <span class="token" style="color:#f1fa8c">"owner_id"</span> = <span class="token" style="color:#f1fa8c">"793219755011"</span> <span class="token" style="color:#f1fa8c">"tags"</span> = tomap(<span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"Name"</span> = <span class="token" style="color:#f1fa8c">"sample-company-vpc-b"</span> <span class="token" style="color:#f1fa8c">"billTo"</span> = <span class="token" style="color:#f1fa8c">"study"</span> <span class="token" style="color:#f1fa8c">"createdBy"</span> = <span class="token" style="color:#f1fa8c">"terraform"</span> <span class="token" style="color:#f1fa8c">"directory"</span> = <span class="token" style="color:#f1fa8c">"peering/terraform_vpc_peering"</span> <span class="token" style="color:#f1fa8c">"environment"</span> = <span class="token" style="color:#f1fa8c">"production"</span> <span class="token" style="color:#f1fa8c">"owner"</span> = <span class="token" style="color:#f1fa8c">"Sample Company"</span> <span class="token punctuation">}</span>) <span class="token punctuation">}</span> <span class="token punctuation">}</span> vpc_config = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"a"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"cidr_vpc"</span> = <span class="token" style="color:#f1fa8c">"10.1.0.0/16"</span> <span class="token" style="color:#f1fa8c">"name"</span> = <span class="token" style="color:#f1fa8c">"sample-company-vpc"</span> <span class="token" style="color:#f1fa8c">"peer_cidr"</span> = <span class="token" style="color:#f1fa8c">"10.2.0.0/16"</span> <span class="token" style="color:#f1fa8c">"region"</span> = <span class="token" style="color:#f1fa8c">"us-west-2"</span> <span class="token" style="color:#f1fa8c">"sg_cidr"</span> = <span class="token punctuation">[</span> <span class="token" style="color:#f1fa8c">"10.1.0.0/16"</span><span class="token punctuation">,</span> <span class="token" style="color:#f1fa8c">"10.2.0.0/16"</span><span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"b"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"cidr_vpc"</span> = <span class="token" style="color:#f1fa8c">"10.2.0.0/16"</span> <span class="token" style="color:#f1fa8c">"name"</span> = <span class="token" style="color:#f1fa8c">"sample-company-vpc"</span> <span class="token" style="color:#f1fa8c">"peer_cidr"</span> = <span class="token" style="color:#f1fa8c">"10.1.0.0/16"</span> <span class="token" style="color:#f1fa8c">"region"</span> = <span class="token" style="color:#f1fa8c">"us-west-2"</span> <span class="token" style="color:#f1fa8c">"sg_cidr"</span> = <span class="token punctuation">[</span> <span class="token" style="color:#f1fa8c">"10.1.0.0/16"</span><span class="token punctuation">,</span> <span class="token" style="color:#f1fa8c">"10.2.0.0/16"</span><span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> igw_ids = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"a"</span> = <span class="token" style="color:#f1fa8c">"igw-0c5265d2efc316c84"</span> <span class="token" style="color:#f1fa8c">"b"</span> = <span class="token" style="color:#f1fa8c">"igw-0a029debee5da18f3"</span> <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">Next I want to create subnets in my VPCs and can again use a local variable to create a map:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25 </span><span class="react-syntax-highlighter-line-number">26 </span><span class="react-syntax-highlighter-line-number">27 </span><span class="react-syntax-highlighter-line-number">28 </span><span class="react-syntax-highlighter-line-number">29 </span><span class="react-syntax-highlighter-line-number">30 </span><span class="react-syntax-highlighter-line-number">31 </span><span class="react-syntax-highlighter-line-number">32 </span><span class="react-syntax-highlighter-line-number">33 </span><span class="react-syntax-highlighter-line-number">34 </span><span class="react-syntax-highlighter-line-number">35 </span><span class="react-syntax-highlighter-line-number">36 </span><span class="react-syntax-highlighter-line-number">37 </span><span class="react-syntax-highlighter-line-number">38 </span><span class="react-syntax-highlighter-line-number">39 </span><span class="react-syntax-highlighter-line-number">40 </span><span class="react-syntax-highlighter-line-number">41 </span><span class="react-syntax-highlighter-line-number">42 </span><span class="react-syntax-highlighter-line-number">43 </span><span class="react-syntax-highlighter-line-number">44 </span><span class="react-syntax-highlighter-line-number">45 </span><span class="react-syntax-highlighter-line-number">46 </span><span class="react-syntax-highlighter-line-number">47 </span><span class="react-syntax-highlighter-line-number">48 </span><span class="react-syntax-highlighter-line-number">49 </span><span class="react-syntax-highlighter-line-number">50 </span><span class="react-syntax-highlighter-line-number">51 </span><span class="react-syntax-highlighter-line-number">52 </span><span class="react-syntax-highlighter-line-number">53 </span><span class="react-syntax-highlighter-line-number">54 </span><span class="react-syntax-highlighter-line-number">55 </span><span class="react-syntax-highlighter-line-number">56 </span><span class="react-syntax-highlighter-line-number">57 </span><span class="react-syntax-highlighter-line-number">58 </span><span class="react-syntax-highlighter-line-number">59 </span><span class="react-syntax-highlighter-line-number">60 </span><span class="react-syntax-highlighter-line-number">61 </span><span class="react-syntax-highlighter-line-number">62 </span><span class="react-syntax-highlighter-line-number">63 </span><span class="react-syntax-highlighter-line-number">64 </span><span class="react-syntax-highlighter-line-number">65 </span><span class="react-syntax-highlighter-line-number">66 </span><span class="react-syntax-highlighter-line-number">67 </span><span class="react-syntax-highlighter-line-number">68 </span><span class="react-syntax-highlighter-line-number">69 </span><span class="react-syntax-highlighter-line-number">70 </span><span class="react-syntax-highlighter-line-number">71 </span><span class="react-syntax-highlighter-line-number">72 </span><span class="react-syntax-highlighter-line-number">73 </span><span class="react-syntax-highlighter-line-number">74 </span><span class="react-syntax-highlighter-line-number">75 </span><span class="react-syntax-highlighter-line-number">76 </span><span class="react-syntax-highlighter-line-number">77 </span><span class="react-syntax-highlighter-line-number">78 </span><span class="react-syntax-highlighter-line-number">79 </span><span class="react-syntax-highlighter-line-number">80 </span><span class="react-syntax-highlighter-line-number">81 </span><span class="react-syntax-highlighter-line-number">82 </span><span class="react-syntax-highlighter-line-number">83 </span><span class="react-syntax-highlighter-line-number">84 </span><span class="react-syntax-highlighter-line-number">85 </span><span class="react-syntax-highlighter-line-number">86 </span><span class="react-syntax-highlighter-line-number">87 </span><span class="react-syntax-highlighter-line-number">88 </span><span class="react-syntax-highlighter-line-number">89 </span><span class="react-syntax-highlighter-line-number">90 </span><span class="react-syntax-highlighter-line-number">91 </span><span class="react-syntax-highlighter-line-number">92 </span><span class="react-syntax-highlighter-line-number">93 </span><span class="react-syntax-highlighter-line-number">94 </span><span class="react-syntax-highlighter-line-number">95 </span><span class="react-syntax-highlighter-line-number">96 </span><span class="react-syntax-highlighter-line-number">97 </span><span class="react-syntax-highlighter-line-number">98 </span><span class="react-syntax-highlighter-line-number">99 </span><span class="react-syntax-highlighter-line-number">100</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">locals <span class="token punctuation">{</span> subnets = <span class="token punctuation">{</span> a_a = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"a"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}a"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.1.0.0/19"</span> public = <span class="token" style="color:#f1fa8c">"true"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"true"</span> api_ip = <span class="token" style="color:#f1fa8c">"10.1.96.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> a_b = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"a"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}b"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.1.32.0/19"</span> public = <span class="token" style="color:#f1fa8c">"true"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"false"</span> api_ip = <span class="token" style="color:#f1fa8c">"10.1.128.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> a_c = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"a"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}c"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.1.64.0/19"</span> public = <span class="token" style="color:#f1fa8c">"true"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"false"</span> api_ip = <span class="token" style="color:#f1fa8c">"10.1.160.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> a_d = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"a"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}a"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.1.96.0/19"</span> public = <span class="token" style="color:#f1fa8c">"false"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"false"</span> private_ip = <span class="token" style="color:#f1fa8c">"10.1.96.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> a_e = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"a"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}b"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.1.128.0/19"</span> public = <span class="token" style="color:#f1fa8c">"false"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"false"</span> private_ip = <span class="token" style="color:#f1fa8c">"10.1.128.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> a_f = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"a"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}c"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.1.160.0/19"</span> public = <span class="token" style="color:#f1fa8c">"false"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"false"</span> private_ip = <span class="token" style="color:#f1fa8c">"10.1.160.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> b_a = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"b"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}a"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.2.0.0/19"</span> public = <span class="token" style="color:#f1fa8c">"true"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"true"</span> api_ip = <span class="token" style="color:#f1fa8c">"10.2.96.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> b_b = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"b"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}b"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.2.32.0/19"</span> public = <span class="token" style="color:#f1fa8c">"true"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"false"</span> api_ip = <span class="token" style="color:#f1fa8c">"10.2.128.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> b_c = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"b"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}c"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.2.64.0/19"</span> public = <span class="token" style="color:#f1fa8c">"true"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"false"</span> api_ip = <span class="token" style="color:#f1fa8c">"10.2.160.10"</span> <span class="token punctuation">}</span> b_d = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"b"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}a"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.2.96.0/19"</span> public = <span class="token" style="color:#f1fa8c">"false"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"false"</span> private_ip = <span class="token" style="color:#f1fa8c">"10.2.96.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> b_e = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"b"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}b"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.2.128.0/19"</span> public = <span class="token" style="color:#f1fa8c">"false"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"false"</span> private_ip = <span class="token" style="color:#f1fa8c">"10.2.128.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> b_f = <span class="token punctuation">{</span> vpc_key = <span class="token" style="color:#f1fa8c">"b"</span><span class="token punctuation">,</span> zone = <span class="token" style="color:#f1fa8c">"${local.region}c"</span><span class="token punctuation">,</span> cidr_block = <span class="token" style="color:#f1fa8c">"10.2.160.0/19"</span> public = <span class="token" style="color:#f1fa8c">"false"</span> nat_gateway = <span class="token" style="color:#f1fa8c">"false"</span> private_ip = <span class="token" style="color:#f1fa8c">"10.2.160.10"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">Because we don't have a one to one relationship between VPCs and subnets, like we did with internet gateways, we will reference our VPCs using their known key values with the vpc_key property (aws_vpc.vpc[each.value.vpc_key].id) in or subnet map. We also introduce using ternary expressions to set tag values:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">resource <span class="token" style="color:#f1fa8c">"aws_subnet"</span> <span class="token" style="color:#f1fa8c">"i"</span> <span class="token punctuation">{</span> for_each = local.subnets vpc_id = aws_vpc.vpc<span class="token punctuation">[</span>each.value.vpc_key<span class="token punctuation">]</span>.id cidr_block = each.value.cidr_block map_public_ip_on_launch = each.value.public availability_zone = each.value.zone tags = merge( local.base_tags<span class="token punctuation">,</span> <span class="token punctuation">{</span> Name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-vpc-${each.key}-${each.value.public == "</span><span class="token boolean">true</span><span class="token" style="color:#f1fa8c">" ? "</span>public<span class="token" style="color:#f1fa8c">" : "</span>private<span class="token" style="color:#f1fa8c">"}"</span> vpc = <span class="token" style="color:#f1fa8c">"vpc-${each.value.vpc_key}"</span> access = each.value.public == <span class="token" style="color:#f1fa8c">"true"</span> ? <span class="token property">"public"</span> <span class="token operator">:</span> <span class="token" style="color:#f1fa8c">"private"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> ) <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">Subnet outputs are generated the same way:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">output <span class="token" style="color:#f1fa8c">"subnet_info"</span> <span class="token punctuation">{</span> value = <span class="token punctuation">{</span> for k<span class="token punctuation">,</span> subnet in local.subnets <span class="token operator">:</span> k => subnet <span class="token punctuation">}</span> <span class="token punctuation">}</span> output <span class="token" style="color:#f1fa8c">"subnet_ids"</span> <span class="token punctuation">{</span> value = <span class="token punctuation">{</span> for k<span class="token punctuation">,</span> subnet in aws_subnet.i <span class="token operator">:</span> k => subnet.id <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">producing</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25 </span><span class="react-syntax-highlighter-line-number">26 </span><span class="react-syntax-highlighter-line-number">27 </span><span class="react-syntax-highlighter-line-number">28 </span><span class="react-syntax-highlighter-line-number">29 </span><span class="react-syntax-highlighter-line-number">30 </span><span class="react-syntax-highlighter-line-number">31 </span><span class="react-syntax-highlighter-line-number">32 </span><span class="react-syntax-highlighter-line-number">33 </span><span class="react-syntax-highlighter-line-number">34 </span><span class="react-syntax-highlighter-line-number">35 </span><span class="react-syntax-highlighter-line-number">36 </span><span class="react-syntax-highlighter-line-number">37 </span><span class="react-syntax-highlighter-line-number">38 </span><span class="react-syntax-highlighter-line-number">39 </span><span class="react-syntax-highlighter-line-number">40 </span><span class="react-syntax-highlighter-line-number">41 </span><span class="react-syntax-highlighter-line-number">42 </span><span class="react-syntax-highlighter-line-number">43 </span><span class="react-syntax-highlighter-line-number">44 </span><span class="react-syntax-highlighter-line-number">45 </span><span class="react-syntax-highlighter-line-number">46 </span><span class="react-syntax-highlighter-line-number">47 </span><span class="react-syntax-highlighter-line-number">48 </span><span class="react-syntax-highlighter-line-number">49 </span><span class="react-syntax-highlighter-line-number">50 </span><span class="react-syntax-highlighter-line-number">51 </span><span class="react-syntax-highlighter-line-number">52 </span><span class="react-syntax-highlighter-line-number">53 </span><span class="react-syntax-highlighter-line-number">54 </span><span class="react-syntax-highlighter-line-number">55 </span><span class="react-syntax-highlighter-line-number">56 </span><span class="react-syntax-highlighter-line-number">57 </span><span class="react-syntax-highlighter-line-number">58 </span><span class="react-syntax-highlighter-line-number">59 </span><span class="react-syntax-highlighter-line-number">60 </span><span class="react-syntax-highlighter-line-number">61 </span><span class="react-syntax-highlighter-line-number">62 </span><span class="react-syntax-highlighter-line-number">63 </span><span class="react-syntax-highlighter-line-number">64 </span><span class="react-syntax-highlighter-line-number">65 </span><span class="react-syntax-highlighter-line-number">66 </span><span class="react-syntax-highlighter-line-number">67 </span><span class="react-syntax-highlighter-line-number">68 </span><span class="react-syntax-highlighter-line-number">69 </span><span class="react-syntax-highlighter-line-number">70 </span><span class="react-syntax-highlighter-line-number">71 </span><span class="react-syntax-highlighter-line-number">72 </span><span class="react-syntax-highlighter-line-number">73 </span><span class="react-syntax-highlighter-line-number">74 </span><span class="react-syntax-highlighter-line-number">75 </span><span class="react-syntax-highlighter-line-number">76 </span><span class="react-syntax-highlighter-line-number">77 </span><span class="react-syntax-highlighter-line-number">78 </span><span class="react-syntax-highlighter-line-number">79 </span><span class="react-syntax-highlighter-line-number">80 </span><span class="react-syntax-highlighter-line-number">81 </span><span class="react-syntax-highlighter-line-number">82 </span><span class="react-syntax-highlighter-line-number">83 </span><span class="react-syntax-highlighter-line-number">84 </span><span class="react-syntax-highlighter-line-number">85 </span><span class="react-syntax-highlighter-line-number">86 </span><span class="react-syntax-highlighter-line-number">87 </span><span class="react-syntax-highlighter-line-number">88 </span><span class="react-syntax-highlighter-line-number">89 </span><span class="react-syntax-highlighter-line-number">90 </span><span class="react-syntax-highlighter-line-number">91 </span><span class="react-syntax-highlighter-line-number">92 </span><span class="react-syntax-highlighter-line-number">93 </span><span class="react-syntax-highlighter-line-number">94 </span><span class="react-syntax-highlighter-line-number">95 </span><span class="react-syntax-highlighter-line-number">96 </span><span class="react-syntax-highlighter-line-number">97 </span><span class="react-syntax-highlighter-line-number">98 </span><span class="react-syntax-highlighter-line-number">99 </span><span class="react-syntax-highlighter-line-number">100 </span><span class="react-syntax-highlighter-line-number">101 </span><span class="react-syntax-highlighter-line-number">102 </span><span class="react-syntax-highlighter-line-number">103 </span><span class="react-syntax-highlighter-line-number">104 </span><span class="react-syntax-highlighter-line-number">105 </span><span class="react-syntax-highlighter-line-number">106 </span><span class="react-syntax-highlighter-line-number">107 </span><span class="react-syntax-highlighter-line-number">108 </span><span class="react-syntax-highlighter-line-number">109 </span><span class="react-syntax-highlighter-line-number">110 </span><span class="react-syntax-highlighter-line-number">111 </span><span class="react-syntax-highlighter-line-number">112</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">subnet_ids = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"a_a"</span> = <span class="token" style="color:#f1fa8c">"subnet-036d8021fa31a75df"</span> <span class="token" style="color:#f1fa8c">"a_b"</span> = <span class="token" style="color:#f1fa8c">"subnet-0c591947f5e3ea68f"</span> <span class="token" style="color:#f1fa8c">"a_c"</span> = <span class="token" style="color:#f1fa8c">"subnet-06719e47a1e6c8d4b"</span> <span class="token" style="color:#f1fa8c">"a_d"</span> = <span class="token" style="color:#f1fa8c">"subnet-0f2ff9bca4118037d"</span> <span class="token" style="color:#f1fa8c">"a_e"</span> = <span class="token" style="color:#f1fa8c">"subnet-0e0bd3a8ab72c77be"</span> <span class="token" style="color:#f1fa8c">"a_f"</span> = <span class="token" style="color:#f1fa8c">"subnet-020cc27bd5f868929"</span> <span class="token" style="color:#f1fa8c">"b_a"</span> = <span class="token" style="color:#f1fa8c">"subnet-0b9742bc7724f6d72"</span> <span class="token" style="color:#f1fa8c">"b_b"</span> = <span class="token" style="color:#f1fa8c">"subnet-0b896d1d35a38eb43"</span> <span class="token" style="color:#f1fa8c">"b_c"</span> = <span class="token" style="color:#f1fa8c">"subnet-0d67b9a34a9843c6a"</span> <span class="token" style="color:#f1fa8c">"b_d"</span> = <span class="token" style="color:#f1fa8c">"subnet-077c4ff53836eab0d"</span> <span class="token" style="color:#f1fa8c">"b_e"</span> = <span class="token" style="color:#f1fa8c">"subnet-094b9eac22a4bfcff"</span> <span class="token" style="color:#f1fa8c">"b_f"</span> = <span class="token" style="color:#f1fa8c">"subnet-006fb422f4668983a"</span> <span class="token punctuation">}</span> subnet_info = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"a_a"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"api_ip"</span> = <span class="token" style="color:#f1fa8c">"10.1.96.10"</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.1.0.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"true"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"true"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"a"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2a"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"a_b"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"api_ip"</span> = <span class="token" style="color:#f1fa8c">"10.1.128.10"</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.1.32.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"true"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"a"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2b"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"a_c"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"api_ip"</span> = <span class="token" style="color:#f1fa8c">"10.1.160.10"</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.1.64.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"true"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"a"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2c"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"a_d"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.1.96.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"private_ip"</span> = <span class="token" style="color:#f1fa8c">"10.1.96.10"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"a"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2a"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"a_e"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.1.128.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"private_ip"</span> = <span class="token" style="color:#f1fa8c">"10.1.128.10"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"a"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2b"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"a_f"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.1.160.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"private_ip"</span> = <span class="token" style="color:#f1fa8c">"10.1.160.10"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"a"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2c"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"b_a"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"api_ip"</span> = <span class="token" style="color:#f1fa8c">"10.2.96.10"</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.2.0.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"true"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"true"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"b"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2a"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"b_b"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"api_ip"</span> = <span class="token" style="color:#f1fa8c">"10.2.128.10"</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.2.32.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"true"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"b"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2b"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"b_c"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"api_ip"</span> = <span class="token" style="color:#f1fa8c">"10.2.160.10"</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.2.64.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"true"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"b"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2c"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"b_d"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.2.96.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"private_ip"</span> = <span class="token" style="color:#f1fa8c">"10.2.96.10"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"b"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2a"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"b_e"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.2.128.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"private_ip"</span> = <span class="token" style="color:#f1fa8c">"10.2.128.10"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"b"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2b"</span> <span class="token punctuation">}</span> <span class="token" style="color:#f1fa8c">"b_f"</span> = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"cidr_block"</span> = <span class="token" style="color:#f1fa8c">"10.2.160.0/19"</span> <span class="token" style="color:#f1fa8c">"nat_gateway"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"private_ip"</span> = <span class="token" style="color:#f1fa8c">"10.2.160.10"</span> <span class="token" style="color:#f1fa8c">"public"</span> = <span class="token" style="color:#f1fa8c">"false"</span> <span class="token" style="color:#f1fa8c">"vpc_key"</span> = <span class="token" style="color:#f1fa8c">"b"</span> <span class="token" style="color:#f1fa8c">"zone"</span> = <span class="token" style="color:#f1fa8c">"us-west-2c"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">After creating our VPCs and Subnets we can then reference the outputs via remote state in a separate EC2 repository.</div><div class="css-1lyp5n8"><a href="https://github.com/arthurdayton116/aws-terraform/tree/main/peering/terraform_ec2_dynamic" target="_blank" p="4">Code located here</a></div><br><div class="css-1lyp5n8">In our data.tf file we define these two local variables:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">subnet_ids = data.terraform_remote_state.vpc.outputs.subnet_ids subnet_info = data.terraform_remote_state.vpc.outputs.subnet_info</code></span></div></div><div class="css-1lyp5n8">Then we can use these maps to create public and private instances of EC2 instances. Here we demonstrate the use of a for loop (for k, subnet in local.subnet_info : k => subnet if subnet.public == "true") to filter our subnet info to only the public subnets. The results of this filtered result set are fed to the for_each and allow us create ec2 instances for only our public subnets:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25 </span><span class="react-syntax-highlighter-line-number">26 </span><span class="react-syntax-highlighter-line-number">27 </span><span class="react-syntax-highlighter-line-number">28 </span><span class="react-syntax-highlighter-line-number">29 </span><span class="react-syntax-highlighter-line-number">30 </span><span class="react-syntax-highlighter-line-number">31 </span><span class="react-syntax-highlighter-line-number">32 </span><span class="react-syntax-highlighter-line-number">33 </span><span class="react-syntax-highlighter-line-number">34 </span><span class="react-syntax-highlighter-line-number">35 </span><span class="react-syntax-highlighter-line-number">36 </span><span class="react-syntax-highlighter-line-number">37 </span><span class="react-syntax-highlighter-line-number">38 </span><span class="react-syntax-highlighter-line-number">39 </span><span class="react-syntax-highlighter-line-number">40 </span><span class="react-syntax-highlighter-line-number">41 </span><span class="react-syntax-highlighter-line-number">42 </span><span class="react-syntax-highlighter-line-number">43 </span><span class="react-syntax-highlighter-line-number">44 </span><span class="react-syntax-highlighter-line-number">45 </span><span class="react-syntax-highlighter-line-number">46 </span><span class="react-syntax-highlighter-line-number">47 </span><span class="react-syntax-highlighter-line-number">48 </span><span class="react-syntax-highlighter-line-number">49 </span><span class="react-syntax-highlighter-line-number">50 </span><span class="react-syntax-highlighter-line-number">51 </span><span class="react-syntax-highlighter-line-number">52 </span><span class="react-syntax-highlighter-line-number">53 </span><span class="react-syntax-highlighter-line-number">54 </span><span class="react-syntax-highlighter-line-number">55 </span><span class="react-syntax-highlighter-line-number">56 </span><span class="react-syntax-highlighter-line-number">57 </span><span class="react-syntax-highlighter-line-number">58 </span><span class="react-syntax-highlighter-line-number">59 </span><span class="react-syntax-highlighter-line-number">60 </span><span class="react-syntax-highlighter-line-number">61 </span><span class="react-syntax-highlighter-line-number">62 </span><span class="react-syntax-highlighter-line-number">63 </span><span class="react-syntax-highlighter-line-number">64 </span><span class="react-syntax-highlighter-line-number">65 </span><span class="react-syntax-highlighter-line-number">66 </span><span class="react-syntax-highlighter-line-number">67 </span><span class="react-syntax-highlighter-line-number">68 </span><span class="react-syntax-highlighter-line-number">69</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">resource <span class="token" style="color:#f1fa8c">"aws_instance"</span> <span class="token" style="color:#f1fa8c">"public"</span> <span class="token punctuation">{</span> for_each = <span class="token punctuation">{</span> for k<span class="token punctuation">,</span> subnet in local.subnet_info <span class="token operator">:</span> k => subnet if subnet.public == <span class="token" style="color:#f1fa8c">"true"</span> <span class="token punctuation">}</span> ami = var.ami_id instance_type = var.ami_instance_type subnet_id = local.subnet_ids<span class="token punctuation">[</span>each.key<span class="token punctuation">]</span> vpc_security_group_ids = <span class="token punctuation">[</span>aws_security_group.ec<span class="token" style="color:#bd93f9">2</span>_public<span class="token punctuation">[</span>each.value.vpc_key<span class="token punctuation">]</span>.id<span class="token punctuation">]</span> key_name = aws_key_pair.ec<span class="token" style="color:#bd93f9">2</span>key.key_name iam_instance_profile = local.s<span class="token" style="color:#bd93f9">3</span>_instance_profile_name <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">// private_ip = local.mc_private_ip</span> user_data = var.user_data provisioner <span class="token" style="color:#f1fa8c">"file"</span> <span class="token punctuation">{</span> source = var.react_path destination = <span class="token" style="color:#f1fa8c">"/tmp"</span> connection <span class="token punctuation">{</span> type = <span class="token" style="color:#f1fa8c">"ssh"</span> user = <span class="token" style="color:#f1fa8c">"ubuntu"</span> private_key = file(var.private_key_path) host = self.public_dns <span class="token punctuation">}</span> <span class="token punctuation">}</span> provisioner <span class="token" style="color:#f1fa8c">"file"</span> <span class="token punctuation">{</span> source = var.go_api_path destination = <span class="token" style="color:#f1fa8c">"/tmp"</span> connection <span class="token punctuation">{</span> type = <span class="token" style="color:#f1fa8c">"ssh"</span> user = <span class="token" style="color:#f1fa8c">"ubuntu"</span> private_key = file(var.private_key_path) host = self.public_dns <span class="token punctuation">}</span> <span class="token punctuation">}</span> provisioner <span class="token" style="color:#f1fa8c">"file"</span> <span class="token punctuation">{</span> source = <span class="token" style="color:#f1fa8c">"goapi@.service"</span> destination = <span class="token" style="color:#f1fa8c">"~/goapi@.service"</span> connection <span class="token punctuation">{</span> type = <span class="token" style="color:#f1fa8c">"ssh"</span> user = <span class="token" style="color:#f1fa8c">"ubuntu"</span> private_key = file(var.private_key_path) host = self.public_dns <span class="token punctuation">}</span> <span class="token punctuation">}</span> provisioner <span class="token" style="color:#f1fa8c">"file"</span> <span class="token punctuation">{</span> source = <span class="token" style="color:#f1fa8c">"dockerStart.sh"</span> destination = <span class="token" style="color:#f1fa8c">"~/dockerStart.sh"</span> connection <span class="token punctuation">{</span> type = <span class="token" style="color:#f1fa8c">"ssh"</span> user = <span class="token" style="color:#f1fa8c">"ubuntu"</span> private_key = file(var.private_key_path) host = self.public_dns <span class="token punctuation">}</span> <span class="token punctuation">}</span> tags = merge( local.base_tags<span class="token punctuation">,</span> <span class="token punctuation">{</span> Name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-${each.key}-ec2_public"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> ) <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">We do the same for private subnets and ultimately are able to create instances within all of our subnets using for_each to loop through the map outputs from our dynamic number of VPCs and Subnets:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25 </span><span class="react-syntax-highlighter-line-number">26 </span><span class="react-syntax-highlighter-line-number">27 </span><span class="react-syntax-highlighter-line-number">28 </span><span class="react-syntax-highlighter-line-number">29 </span><span class="react-syntax-highlighter-line-number">30 </span><span class="react-syntax-highlighter-line-number">31 </span><span class="react-syntax-highlighter-line-number">32 </span><span class="react-syntax-highlighter-line-number">33 </span><span class="react-syntax-highlighter-line-number">34</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">key_id = <span class="token" style="color:#f1fa8c">"sample-company_publicKey"</span> key_name = <span class="token" style="color:#f1fa8c">"sample-company_publicKey"</span> public_ssh_link = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"a_a"</span> = <span class="token" style="color:#f1fa8c">"ssh -i ~/.ssh/id_rsa_ec2 ubuntu@35.165.242.82"</span> <span class="token" style="color:#f1fa8c">"a_b"</span> = <span class="token" style="color:#f1fa8c">"ssh -i ~/.ssh/id_rsa_ec2 ubuntu@34.221.13.100"</span> <span class="token" style="color:#f1fa8c">"a_c"</span> = <span class="token" style="color:#f1fa8c">"ssh -i ~/.ssh/id_rsa_ec2 ubuntu@18.237.136.196"</span> <span class="token" style="color:#f1fa8c">"b_a"</span> = <span class="token" style="color:#f1fa8c">"ssh -i ~/.ssh/id_rsa_ec2 ubuntu@35.163.62.108"</span> <span class="token" style="color:#f1fa8c">"b_b"</span> = <span class="token" style="color:#f1fa8c">"ssh -i ~/.ssh/id_rsa_ec2 ubuntu@34.211.122.232"</span> <span class="token" style="color:#f1fa8c">"b_c"</span> = <span class="token" style="color:#f1fa8c">"ssh -i ~/.ssh/id_rsa_ec2 ubuntu@54.186.21.110"</span> <span class="token punctuation">}</span> webserver_ips = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"a_a"</span> = <span class="token" style="color:#f1fa8c">"35.165.242.82"</span> <span class="token" style="color:#f1fa8c">"a_b"</span> = <span class="token" style="color:#f1fa8c">"34.221.13.100"</span> <span class="token" style="color:#f1fa8c">"a_c"</span> = <span class="token" style="color:#f1fa8c">"18.237.136.196"</span> <span class="token" style="color:#f1fa8c">"b_a"</span> = <span class="token" style="color:#f1fa8c">"35.163.62.108"</span> <span class="token" style="color:#f1fa8c">"b_b"</span> = <span class="token" style="color:#f1fa8c">"34.211.122.232"</span> <span class="token" style="color:#f1fa8c">"b_c"</span> = <span class="token" style="color:#f1fa8c">"54.186.21.110"</span> <span class="token punctuation">}</span> webserver_link = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"a_a"</span> = <span class="token" style="color:#f1fa8c">"http://35.165.242.82"</span> <span class="token" style="color:#f1fa8c">"a_b"</span> = <span class="token" style="color:#f1fa8c">"http://34.221.13.100"</span> <span class="token" style="color:#f1fa8c">"a_c"</span> = <span class="token" style="color:#f1fa8c">"http://18.237.136.196"</span> <span class="token" style="color:#f1fa8c">"b_a"</span> = <span class="token" style="color:#f1fa8c">"http://35.163.62.108"</span> <span class="token" style="color:#f1fa8c">"b_b"</span> = <span class="token" style="color:#f1fa8c">"http://34.211.122.232"</span> <span class="token" style="color:#f1fa8c">"b_c"</span> = <span class="token" style="color:#f1fa8c">"http://54.186.21.110"</span> <span class="token punctuation">}</span> webserver_privateips = <span class="token punctuation">{</span> <span class="token" style="color:#f1fa8c">"a_a"</span> = <span class="token" style="color:#f1fa8c">"10.1.5.23"</span> <span class="token" style="color:#f1fa8c">"a_b"</span> = <span class="token" style="color:#f1fa8c">"10.1.50.207"</span> <span class="token" style="color:#f1fa8c">"a_c"</span> = <span class="token" style="color:#f1fa8c">"10.1.77.83"</span> <span class="token" style="color:#f1fa8c">"b_a"</span> = <span class="token" style="color:#f1fa8c">"10.2.0.88"</span> <span class="token" style="color:#f1fa8c">"b_b"</span> = <span class="token" style="color:#f1fa8c">"10.2.42.2"</span> <span class="token" style="color:#f1fa8c">"b_c"</span> = <span class="token" style="color:#f1fa8c">"10.2.95.69"</span> <span class="token punctuation">}</span></code></span></div></div><div class="css-iyq5fi"><h5 class="css-qjyand">Conclusion</h5></div><div class="css-1lyp5n8">As this example shows Terraform can be used to dynamically create multiple types of interrelated resources using maps to create instance configurations and for_each loops to iterate over them.</div><br></div></div></div><div>Error: Failed to fetch</div></div></div></div><script>!function(a){function r(r){for(var t,c,_=r[0],n=r[1],i=r[2],l=0,o=[];l<_.length;l++)c=_[l],Object.prototype.hasOwnProperty.call(g,c)&&g[c]&&o.push(g[c][0]),g[c]=0;for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(a[t]=n[t]);for(s&&s(r);o.length;)o.shift()();return h.push.apply(h,i||[]),e()}function e(){for(var a,r=0;r<h.length;r++){for(var e=h[r],t=!0,_=1;_<e.length;_++){var n=e[_];0!==g[n]&&(t=!1)}t&&(h.splice(r--,1),a=c(c.s=e[0]))}return a}var t={},g={152:0},h=[];function c(r){if(t[r])return t[r].exports;var e=t[r]={i:r,l:!1,exports:{}};return a[r].call(e.exports,e,e.exports,c),e.l=!0,e.exports}c.e=function(a){var r=[],e=g[a];if(0!==e)if(e)r.push(e[2]);else{var t=new Promise((function(r,t){e=g[a]=[r,t]}));r.push(e[2]=t);var h,_=document.createElement("script");_.charset="utf-8",_.timeout=120,c.nc&&_.setAttribute("nonce",c.nc),_.src=function(a){return c.p+"static/js/"+({1:"react-syntax-highlighter_languages_refractor_abap",2:"react-syntax-highlighter_languages_refractor_actionscript",3:"react-syntax-highlighter_languages_refractor_ada",4:"react-syntax-highlighter_languages_refractor_apacheconf",5:"react-syntax-highlighter_languages_refractor_apl",6:"react-syntax-highlighter_languages_refractor_applescript",7:"react-syntax-highlighter_languages_refractor_arduino",8:"react-syntax-highlighter_languages_refractor_arff",9:"react-syntax-highlighter_languages_refractor_asciidoc",10:"react-syntax-highlighter_languages_refractor_asm6502",11:"react-syntax-highlighter_languages_refractor_aspnet",12:"react-syntax-highlighter_languages_refractor_autohotkey",13:"react-syntax-highlighter_languages_refractor_autoit",14:"react-syntax-highlighter_languages_refractor_bash",15:"react-syntax-highlighter_languages_refractor_basic",16:"react-syntax-highlighter_languages_refractor_batch",17:"react-syntax-highlighter_languages_refractor_bison",18:"react-syntax-highlighter_languages_refractor_brainfuck",19:"react-syntax-highlighter_languages_refractor_bro",20:"react-syntax-highlighter_languages_refractor_c",21:"react-syntax-highlighter_languages_refractor_clike",22:"react-syntax-highlighter_languages_refractor_clojure",23:"react-syntax-highlighter_languages_refractor_coffeescript",24:"react-syntax-highlighter_languages_refractor_cpp",25:"react-syntax-highlighter_languages_refractor_crystal",26:"react-syntax-highlighter_languages_refractor_csharp",27:"react-syntax-highlighter_languages_refractor_csp",28:"react-syntax-highlighter_languages_refractor_css",29:"react-syntax-highlighter_languages_refractor_cssExtras",30:"react-syntax-highlighter_languages_refractor_d",31:"react-syntax-highlighter_languages_refractor_dart",32:"react-syntax-highlighter_languages_refractor_diff",33:"react-syntax-highlighter_languages_refractor_django",34:"react-syntax-highlighter_languages_refractor_docker",35:"react-syntax-highlighter_languages_refractor_eiffel",36:"react-syntax-highlighter_languages_refractor_elixir",37:"react-syntax-highlighter_languages_refractor_elm",38:"react-syntax-highlighter_languages_refractor_erb",39:"react-syntax-highlighter_languages_refractor_erlang",40:"react-syntax-highlighter_languages_refractor_flow",41:"react-syntax-highlighter_languages_refractor_fortran",42:"react-syntax-highlighter_languages_refractor_fsharp",43:"react-syntax-highlighter_languages_refractor_gedcom",44:"react-syntax-highlighter_languages_refractor_gherkin",45:"react-syntax-highlighter_languages_refractor_git",46:"react-syntax-highlighter_languages_refractor_glsl",47:"react-syntax-highlighter_languages_refractor_go",48:"react-syntax-highlighter_languages_refractor_graphql",49:"react-syntax-highlighter_languages_refractor_groovy",50:"react-syntax-highlighter_languages_refractor_haml",51:"react-syntax-highlighter_languages_refractor_handlebars",52:"react-syntax-highlighter_languages_refractor_haskell",53:"react-syntax-highlighter_languages_refractor_haxe",54:"react-syntax-highlighter_languages_refractor_hpkp",55:"react-syntax-highlighter_languages_refractor_hsts",56:"react-syntax-highlighter_languages_refractor_http",57:"react-syntax-highlighter_languages_refractor_ichigojam",58:"react-syntax-highlighter_languages_refractor_icon",59:"react-syntax-highlighter_languages_refractor_inform7",60:"react-syntax-highlighter_languages_refractor_ini",61:"react-syntax-highlighter_languages_refractor_io",62:"react-syntax-highlighter_languages_refractor_j",63:"react-syntax-highlighter_languages_refractor_java",64:"react-syntax-highlighter_languages_refractor_javascript",65:"react-syntax-highlighter_languages_refractor_jolie",66:"react-syntax-highlighter_languages_refractor_json",67:"react-syntax-highlighter_languages_refractor_jsx",68:"react-syntax-highlighter_languages_refractor_julia",69:"react-syntax-highlighter_languages_refractor_keyman",70:"react-syntax-highlighter_languages_refractor_kotlin",71:"react-syntax-highlighter_languages_refractor_latex",72:"react-syntax-highlighter_languages_refractor_less",73:"react-syntax-highlighter_languages_refractor_liquid",74:"react-syntax-highlighter_languages_refractor_lisp",75:"react-syntax-highlighter_languages_refractor_livescript",76:"react-syntax-highlighter_languages_refractor_lolcode",77:"react-syntax-highlighter_languages_refractor_lua",78:"react-syntax-highlighter_languages_refractor_makefile",79:"react-syntax-highlighter_languages_refractor_markdown",80:"react-syntax-highlighter_languages_refractor_markup",81:"react-syntax-highlighter_languages_refractor_markupTemplating",82:"react-syntax-highlighter_languages_refractor_matlab",83:"react-syntax-highlighter_languages_refractor_mel",84:"react-syntax-highlighter_languages_refractor_mizar",85:"react-syntax-highlighter_languages_refractor_monkey",86:"react-syntax-highlighter_languages_refractor_n4js",87:"react-syntax-highlighter_languages_refractor_nasm",88:"react-syntax-highlighter_languages_refractor_nginx",89:"react-syntax-highlighter_languages_refractor_nim",90:"react-syntax-highlighter_languages_refractor_nix",91:"react-syntax-highlighter_languages_refractor_nsis",92:"react-syntax-highlighter_languages_refractor_objectivec",93:"react-syntax-highlighter_languages_refractor_ocaml",94:"react-syntax-highlighter_languages_refractor_opencl",95:"react-syntax-highlighter_languages_refractor_oz",96:"react-syntax-highlighter_languages_refractor_parigp",97:"react-syntax-highlighter_languages_refractor_parser",98:"react-syntax-highlighter_languages_refractor_pascal",99:"react-syntax-highlighter_languages_refractor_perl",100:"react-syntax-highlighter_languages_refractor_php",101:"react-syntax-highlighter_languages_refractor_phpExtras",102:"react-syntax-highlighter_languages_refractor_plsql",103:"react-syntax-highlighter_languages_refractor_powershell",104:"react-syntax-highlighter_languages_refractor_processing",105:"react-syntax-highlighter_languages_refractor_prolog",106:"react-syntax-highlighter_languages_refractor_properties",107:"react-syntax-highlighter_languages_refractor_protobuf",108:"react-syntax-highlighter_languages_refractor_pug",109:"react-syntax-highlighter_languages_refractor_puppet",110:"react-syntax-highlighter_languages_refractor_pure",111:"react-syntax-highlighter_languages_refractor_python",112:"react-syntax-highlighter_languages_refractor_q",113:"react-syntax-highlighter_languages_refractor_qore",114:"react-syntax-highlighter_languages_refractor_r",115:"react-syntax-highlighter_languages_refractor_reason",116:"react-syntax-highlighter_languages_refractor_renpy",117:"react-syntax-highlighter_languages_refractor_rest",118:"react-syntax-highlighter_languages_refractor_rip",119:"react-syntax-highlighter_languages_refractor_roboconf",120:"react-syntax-highlighter_languages_refractor_ruby",121:"react-syntax-highlighter_languages_refractor_rust",122:"react-syntax-highlighter_languages_refractor_sas",123:"react-syntax-highlighter_languages_refractor_sass",124:"react-syntax-highlighter_languages_refractor_scala",125:"react-syntax-highlighter_languages_refractor_scheme",126:"react-syntax-highlighter_languages_refractor_scss",127:"react-syntax-highlighter_languages_refractor_smalltalk",128:"react-syntax-highlighter_languages_refractor_smarty",129:"react-syntax-highlighter_languages_refractor_soy",130:"react-syntax-highlighter_languages_refractor_sql",131:"react-syntax-highlighter_languages_refractor_stylus",132:"react-syntax-highlighter_languages_refractor_swift",133:"react-syntax-highlighter_languages_refractor_tap",134:"react-syntax-highlighter_languages_refractor_tcl",135:"react-syntax-highlighter_languages_refractor_textile",136:"react-syntax-highlighter_languages_refractor_tsx",137:"react-syntax-highlighter_languages_refractor_tt2",138:"react-syntax-highlighter_languages_refractor_twig",139:"react-syntax-highlighter_languages_refractor_typescript",140:"react-syntax-highlighter_languages_refractor_vbnet",141:"react-syntax-highlighter_languages_refractor_velocity",142:"react-syntax-highlighter_languages_refractor_verilog",143:"react-syntax-highlighter_languages_refractor_vhdl",144:"react-syntax-highlighter_languages_refractor_vim",145:"react-syntax-highlighter_languages_refractor_visualBasic",146:"react-syntax-highlighter_languages_refractor_wasm",147:"react-syntax-highlighter_languages_refractor_wiki",148:"react-syntax-highlighter_languages_refractor_xeora",149:"react-syntax-highlighter_languages_refractor_xojo",150:"react-syntax-highlighter_languages_refractor_xquery",151:"react-syntax-highlighter_languages_refractor_yaml"}[a]||a)+"."+{1:"5ce0a218",2:"c91906ac",3:"adb19a44",4:"cc59464f",5:"f8993fd3",6:"66911c33",7:"5678a631",8:"d949ca17",9:"11560d88",10:"4e2e0fa1",11:"834e2292",12:"2ce03349",13:"0a73301c",14:"e194bbbb",15:"f026f83e",16:"2510a051",17:"3025470a",18:"83c4b6a1",19:"625bc7e9",20:"425910a3",21:"0955efde",22:"49466316",23:"1e18b429",24:"89a4c21a",25:"97091f1c",26:"fb21a125",27:"efcc5dec",28:"798fc99c",29:"a64f1295",30:"2ad7f268",31:"752a7496",32:"ce8cb85b",33:"f252dd21",34:"e5a0a512",35:"4a522aed",36:"583b5291",37:"41627fdd",38:"a60636d5",39:"7d2b660e",40:"9f9caa05",41:"33e0a0be",42:"7ad17005",43:"3dd1d2cc",44:"af660035",45:"9bbd406f",46:"f33a63fe",47:"a527f8cd",48:"78ecb5b0",49:"fa62ae82",50:"bcab50bd",51:"68786be8",52:"0fc354df",53:"7b33298d",54:"5389b745",55:"b6b2694f",56:"e69823e4",57:"e9fffe32",58:"29b25347",59:"9ecb9913",60:"3019a210",61:"1c1966ce",62:"b0f01e61",63:"b668e591",64:"ae7fe12c",65:"fba34806",66:"4e8e5b51",67:"afd8d23f",68:"e9bc2e28",69:"e1b48b11",70:"71e13449",71:"ed9bd742",72:"d63c29a7",73:"ec563105",74:"be07d8f7",75:"c45c435f",76:"eec3a11a",77:"c71772c6",78:"83403a42",79:"39fb8379",80:"5c2cc6db",81:"54a1b646",82:"5dd28799",83:"3d6f1c42",84:"c07eea11",85:"132da623",86:"4d8dcfe2",87:"90a2605d",88:"b06436d9",89:"c15e7982",90:"13c30075",91:"c5451263",92:"82528a50",93:"b29b2026",94:"6f6bdd6b",95:"8e8a5aee",96:"ff046490",97:"014571a1",98:"5d510ebc",99:"28d00c1e",100:"10e5a5e8",101:"b350c939",102:"0c72bb14",103:"8a37cff1",104:"31f0e00c",105:"11333ac6",106:"cfcd1faf",107:"0dd25f3d",108:"636e0118",109:"f1d8d625",110:"21f631b6",111:"b5d4777f",112:"c4cd0a66",113:"c098c4a9",114:"1676e00f",115:"e3116b4b",116:"75af7e7f",117:"e3ebfa0b",118:"df0c16e9",119:"d0d38da4",120:"db9cbd2b",121:"1ed3e15e",122:"7de42bad",123:"dda9ddd6",124:"c9201289",125:"8469f737",126:"a3728a0d",127:"4f072bc0",128:"35b326fb",129:"efd892a8",130:"2e9f1735",131:"b4f7d9a6",132:"0177a5f0",133:"aee746a2",134:"cdb64fd8",135:"e3087533",136:"a2157c33",137:"6511895c",138:"214f604f",139:"cfd6aa4b",140:"14ec90ac",141:"b6a54011",142:"940c431c",143:"bc223863",144:"69f5b598",145:"e11aa54e",146:"724f305c",147:"f0739ea2",148:"221a4511",149:"b9295dfa",150:"b70d910a",151:"aaa07edf",154:"730b755d",155:"2b1e9348",156:"1326124f",157:"db2df864",158:"5a401d60",159:"a6b932ab",160:"b424bf2f",161:"9ae70339"}[a]+".chunk.js"}(a);var n=new Error;h=function(r){_.onerror=_.onload=null,clearTimeout(i);var e=g[a];if(0!==e){if(e){var t=r&&("load"===r.type?"missing":r.type),h=r&&r.target&&r.target.src;n.message="Loading chunk "+a+" failed.\n("+t+": "+h+")",n.name="ChunkLoadError",n.type=t,n.request=h,e[1](n)}g[a]=void 0}};var i=setTimeout((function(){h({type:"timeout",target:_})}),12e4);_.onerror=_.onload=h,document.head.appendChild(_)}return Promise.all(r)},c.m=a,c.c=t,c.d=function(a,r,e){c.o(a,r)||Object.defineProperty(a,r,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,r){if(1&r&&(a=c(a)),8&r)return a;if(4&r&&"object"==typeof a&&a&&a.__esModule)return a;var e=Object.create(null);if(c.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:a}),2&r&&"string"!=typeof a)for(var t in a)c.d(e,t,function(r){return a[r]}.bind(null,t));return e},c.n=function(a){var r=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(r,"a",r),r},c.o=function(a,r){return Object.prototype.hasOwnProperty.call(a,r)},c.p="/",c.oe=function(a){throw console.error(a),a};var _=this["webpackJsonpblog-site"]=this["webpackJsonpblog-site"]||[],n=_.push.bind(_);_.push=r,_=_.slice();for(var i=0;i<_.length;i++)r(_[i]);var s=n;e()}([])</script><script src="/static/js/153.2eb38fd0.chunk.js"></script><script src="/static/js/main.59b35fd3.chunk.js"></script></body></html>