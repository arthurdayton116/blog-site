<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link href="/favicon.ico" rel="icon"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="#000000" name="theme-color"><link href="/logo192.png" rel="apple-touch-icon"><link href="/manifest.json" rel="manifest"><title>Arthur Dayton Blog Site</title><link href="/static/css/main.0d183a93.chunk.css" rel="stylesheet"><style data-emotion="css">.css-vurnku{box-sizing:border-box;margin:0;min-width:0}.css-oxi7wx{box-sizing:border-box;margin:0;min-width:0;padding-bottom:8px}@media screen and (min-width:40em){.css-oxi7wx{padding-bottom:8px}}@media screen and (min-width:52em){.css-oxi7wx{padding-bottom:32px}}.css-1o61k66{box-sizing:border-box;margin:0;min-width:0;background-color:#000;-webkit-box-align:center;align-items:center;display:flex}.css-ozbgqc{box-sizing:border-box;margin:0;min-width:0;max-width:100%;width:54.4px;height:37px;border-radius:0;display:none}@media screen and (min-width:40em){.css-ozbgqc{width:108.8px;height:74px}}@media screen and (min-width:52em){.css-ozbgqc{width:136px;height:92.5px}}@media screen and (min-width:40em){.css-ozbgqc{display:block}}@media screen and (min-width:52em){.css-ozbgqc{display:block}}.css-1nqru1l{box-sizing:border-box;margin:0;min-width:0;color:#e9ecf5;font-weight:700;font-size:1.5em;text-decoration:none;padding:4px;display:none}@media screen and (min-width:40em){.css-1nqru1l{padding:16px}}@media screen and (min-width:52em){.css-1nqru1l{padding:16px}}.css-1nqru1l:hover{color:#ccd6eb;font-weight:900}@media screen and (min-width:40em){.css-1nqru1l{display:block}}@media screen and (min-width:52em){.css-1nqru1l{display:block}}.css-1ntkiwo{box-sizing:border-box;margin:0 auto;min-width:0}.css-hrpk47{box-sizing:border-box;margin:0;min-width:0;color:#e9ecf5;font-weight:700;text-decoration:none;padding:4px 32px 4px 4px;display:block;font-size:20px}@media screen and (min-width:40em){.css-hrpk47{padding:16px}}@media screen and (min-width:52em){.css-hrpk47{padding:16px}}.css-hrpk47:hover{color:#ccd6eb;font-weight:900}@media screen and (min-width:40em){.css-hrpk47{display:none;font-size:24px}}@media screen and (min-width:52em){.css-hrpk47{display:none;font-size:24px}}.css-1co1q8w{box-sizing:border-box;margin:0;min-width:0;background-color:#ccd6eb;display:none}.css-1wc86sm{box-sizing:border-box;margin:0;min-width:0;flex-wrap:wrap;text-align:right;display:flex}.css-npj7sz{box-sizing:border-box;margin:0;min-width:0;width:100%;padding:8px}.css-10yqanw{box-sizing:border-box;margin:0;min-width:0;color:#566db3;font-weight:700;font-size:1em;text-decoration:none;padding:16px}.css-10yqanw:hover{color:#ccd6eb;font-weight:900}.css-7um157{box-sizing:border-box;margin:0;min-width:0;height:37px}@media screen and (min-width:40em){.css-7um157{height:74px}}@media screen and (min-width:52em){.css-7um157{height:92.5px}}.css-1u6ks9t{box-sizing:border-box;margin:0;min-width:0;padding-left:8px}@media screen and (min-width:40em){.css-1u6ks9t{padding-left:8px}}@media screen and (min-width:52em){.css-1u6ks9t{padding-left:32px}}.css-93hpa0{box-sizing:border-box;margin:0;min-width:0;padding:0;font-family:arial}@media screen and (min-width:40em){.css-93hpa0{padding:8px}}@media screen and (min-width:52em){.css-93hpa0{padding:32px}}.css-1vzt88e{box-sizing:border-box;margin:0;min-width:0;padding-left:0;padding-top:0;padding-bottom:0}@media screen and (min-width:40em){.css-1vzt88e{padding-left:8px;padding-top:8px;padding-bottom:8px}}@media screen and (min-width:52em){.css-1vzt88e{padding-left:32px;padding-top:32px;padding-bottom:32px}}.css-yz2fnm{box-sizing:border-box;margin:0;min-width:0;font-size:24px;color:#000;font-family:Arial,sans-serif}.css-1bo66fg{box-sizing:border-box;margin:0;min-width:0;color:#000;font-family:Arial,sans-serif;font-size:.75em;padding-left:8px;padding-top:8px}.css-18ybmw{box-sizing:border-box;margin:0;min-width:0;color:#000;font-family:Arial,sans-serif;font-size:.75em;padding-left:8px}.css-4ax88y{box-sizing:border-box;margin:0;min-width:0;color:#000;font-family:Arial,sans-serif;font-size:.75em;padding-left:8px;padding-bottom:8px}.css-1ucrkln{box-sizing:border-box;margin:0;min-width:0;padding-top:8px;padding-left:0}@media screen and (min-width:40em){.css-1ucrkln{padding-left:8px}}@media screen and (min-width:52em){.css-1ucrkln{padding-left:32px}}.css-iyq5fi{box-sizing:border-box;margin:0;min-width:0;padding-left:0;padding-top:8px;padding-bottom:8px}@media screen and (min-width:40em){.css-iyq5fi{padding-left:8px}}@media screen and (min-width:52em){.css-iyq5fi{padding-left:16px}}.css-1lyp5n8{box-sizing:border-box;margin:8px 0;min-width:0}@media screen and (min-width:40em){.css-1lyp5n8{margin-left:8px}}@media screen and (min-width:52em){.css-1lyp5n8{margin-left:32px}}.css-1f4itik{box-sizing:border-box;margin:0;min-width:0}@media screen and (min-width:40em){.css-1f4itik{margin-left:8px}}@media screen and (min-width:52em){.css-1f4itik{margin-left:32px}}.css-1stgykt{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;padding:32px;vertical-align:middle}.css-3gdh81{box-sizing:border-box;margin:0;min-width:0;padding:32px}.css-1uzs5fn{box-sizing:border-box;margin:0;min-width:0;padding-top:0;padding-bottom:0;padding-left:0;font-size:.75em}@media screen and (min-width:40em){.css-1uzs5fn{padding-top:8px;padding-bottom:8px;padding-left:8px;font-size:1.5em}}@media screen and (min-width:52em){.css-1uzs5fn{padding-top:32px;padding-bottom:32px;padding-left:16px;font-size:1.5em}}</style><script src="/static/js/155.2b1e9348.chunk.js" charset="utf-8"></script><meta content="Arthur Dayton Blog" data-react-helmet="true" property="og:title"><meta content="Arthur uses this site to blog about and demonstrate technology concepts.  It is currently deployed using serverless technologies on AWS." data-react-helmet="true" property="og:description"><meta content="%PUBLIC_URL%/ObservatoryPark.jpg" data-react-helmet="true" property="og:image"><meta content="Arthur Dayton" data-react-helmet="true" property="article:author"><meta content="2022-02-16" data-react-helmet="true" property="article:published_time"><script src="/static/js/154.730b755d.chunk.js" charset="utf-8"></script><script src="/static/js/react-syntax-highlighter_languages_refractor_json.4e8e5b51.chunk.js" charset="utf-8"></script><script src="/static/js/react-syntax-highlighter_languages_refractor_bash.e194bbbb.chunk.js" charset="utf-8"></script></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="css-vurnku" style="position:fixed;width:100%"><div class="css-oxi7wx"><div class="css-1o61k66"><img class="css-ozbgqc" src="/static/media/ObservatoryPark.ba50a4b1.jpg"><a class="css-1nqru1l" href="/blog">Blog</a><a class="css-1nqru1l" href="/about">About</a><a class="css-1nqru1l" id="logOnButton">LogIn</a><div class="css-1ntkiwo"></div><div class="css-hrpk47"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 448 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></div></div><div class="css-1co1q8w"><div class="css-1wc86sm"><div class="css-npj7sz"><a class="css-10yqanw" href="/blog">Blog</a></div><div class="css-npj7sz"><a class="css-10yqanw" href="/about">About</a></div></div></div></div></div><div class="css-7um157"></div><div class="css-1u6ks9t"><div class="css-vurnku" id="post_page_parent_3"><div class="css-93hpa0"><div class="css-1vzt88e"><h1 class="css-yz2fnm">A Minecraft server for my kids</h1><h5 class="css-1bo66fg"><div class="css-vurnku">Tech: AWS - EC2 - Terraform - Minecraft - Systemctl - Ubuntu</div></h5><h5 class="css-18ybmw">Posted: 2021-02-28</h5><h5 class="css-4ax88y">Last Updated: 2021-02-28</h5></div><div class="css-1ucrkln"><div><div class="css-iyq5fi"><h4 class="css-yz2fnm">Wait... what?</h4></div><div class="css-1lyp5n8">I was looking for a way to demonstrate deploying EC2 instances into my VPC but was looking for a real world problem to solve while I did it. As it turns out, despite all efforts to insulate them from the insidious lure of gaming (read mom), my kids LOVE Minecraft. I have been into technology for most of my life, and make a living off of my knowledge of it, but I am not a gamer. Until now I have never had the motivation to try setting up a Minecraft server but now that the kids have tasted the forbidden fruit of multiplayer video games they, of course, want to play online with their friends. You can purchase a server online from about 5000 different places and be done with it but it isn't exactly cheap for anything bigger than a Raspberry PI and this is my chance to look cool to my kids by being a hacker (my kids define hacker as anything cool you can do with a computer that involves a terminal window). So, in the spirit of all who enjoy watching people change the gear ratio on a riding lawnmower to make it go 40 mph, I thought I can contribute to my children's delinquency by giving them a variably sized Minecraft server that they can fire up whenever they want AND make a blog post. Given this obvious pressing need, I decided to set the kids up with an automatically deployed Minecraft server using Terraform and AWS. It saves their world in between sessions in an S3 bucket so we can completely tear it down when they are not using it but can start up a new server on demand right where they left off in the game.</div><br><div class="css-1lyp5n8">Ok, so now that we have an important real world problem to solve, lets list our requirements and plan out an architecture:</div><ul style="list-style-type:square"><div class="css-1f4itik"><span style="padding-left:0"><li>We are obviously going to need some compute so we'll use an EC2 ami with Ubuntu which will require a <a class="css-vurnku" href="post/2" target="_blank">VPC</a>.</li><li>We want to be secure so we need a way to feed in an arbitrary list of allowed IP addresses that can access the instance (Route table and Security Group).</li><li>We need to install software and have it start up automatically (User Data and Systemctl).</li><li>We need to preserve game state from previous sessions (S3).</li><li>We need a simple way to distribute access to our server across the planet (AWS).</li><li>To prove our servers are alive and accessible we will install an <a class="css-vurnku" href="https://httpd.apache.org/" target="_blank">Apache HTTP Server</a>.</li><li>Seeing as we are already here - with a few more lines of code - we can show how a private subnet works with a NAT gateway (all the Minecraft stuff works fine without these parts) and demonstrate the difference between a public and private instance.</li></span></div></ul><br><div class="css-1lyp5n8">This diagram shows our basic architecture and gives us a way to break down our components into distinct stories for implementation.</div><img class="css-1stgykt" src="/static/media/MC_Arch.9dad859d.png"><br>My previous post on creating a VPC gives us the outer portion of the diagram so if my turn off the VPC layer we can see what we need to implement here:<br><img class="css-1stgykt" src="/static/media/EC2_Components.873dd752.png"><br><div class="css-1lyp5n8">I'll assume you can handle the implementation of the kids on your own so lets start with the S3 bucket.</div><br><div class="css-iyq5fi"><h4 class="css-yz2fnm">Create S3 Bucket</h4></div><a class="css-3gdh81" href="https://github.com/arthurdayton116/aws-terraform/tree/main/terraform_s3" target="_blank">Code located here</a><br><div class="css-1lyp5n8">Creating an S3 bucket is pretty simple with the the aws_s3_bucket resource in Terraform. We will set ours to be privately accessible, so only our EC2 instance can reach it, and protect it from destruction if it has contents:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">resource <span class="token" style="color:#f1fa8c">"aws_s3_bucket"</span> <span class="token" style="color:#f1fa8c">"mc"</span> <span class="token punctuation">{</span> bucket = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-bucket"</span> acl = <span class="token" style="color:#f1fa8c">"private"</span> force_destroy = <span class="token boolean">false</span> tags = merge( local.base_tags<span class="token punctuation">,</span> <span class="token punctuation">{</span> Name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-mc-s3"</span> directory = basename(path.cwd) <span class="token punctuation">}</span><span class="token punctuation">,</span> ) <span class="token punctuation">}</span></code></span></div></div><br><div class="css-iyq5fi"><h4 class="css-yz2fnm">Create role and policy to access bucket with EC2 instance</h4></div><div class="css-1lyp5n8">Creating the role and permission we need to access it with our EC2 instance is a little harder but not to bad.</div><br><div class="css-1lyp5n8">From the AWS Docs <a class="css-vurnku" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html" target="_blank">IAM roles</a></div><hr><div class="css-1lyp5n8">An IAM role is an IAM identity that you can create in your account that has specific permissions. An IAM role is similar to an IAM user, in that it is an AWS identity with permission policies that determine what the identity can and cannot do in AWS. However, instead of being uniquely associated with one person, a role is intended to be assumable by anyone who needs it. Also, a role does not have standard long-term credentials such as a password or access keys associated with it. Instead, when you assume a role, it provides you with temporary security credentials for your role session.</div><hr><br><div class="css-1lyp5n8">From the AWS Docs <a class="css-vurnku" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html" target="_blank">Policies and permissions in IAM</a></div><hr><div class="css-1lyp5n8">You manage access in AWS by creating policies and attaching them to IAM identities (users, groups of users, or roles) or AWS resources. A policy is an object in AWS that, when associated with an identity or resource, defines their permissions. AWS evaluates these policies when an IAM principal (user or role) makes a request. Permissions in the policies determine whether the request is allowed or denied. Most policies are stored in AWS as JSON documents. AWS supports six types of policies: identity-based policies, resource-based policies, permissions boundaries, Organizations SCPs, ACLs, and session policies.</div><hr><br><div class="css-1lyp5n8">These descriptions explain that a role is an identity and a policy is a set of permissions. Once we associate a role and a policy we can then grant that role to a user, or in our case a service, and we will have given our service permission to do something (read/write to an S3 bucket in this case).</div><br><div class="css-1lyp5n8">First we define a role with the Terraform aws_iam_role resource for the EC2 instance we plan to create. This will allow the EC2 service to access resources in our account:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">resource <span class="token" style="color:#f1fa8c">"aws_iam_role"</span> <span class="token" style="color:#f1fa8c">"ec2_s3_access_role"</span> <span class="token punctuation">{</span> name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-s3-role"</span> assume_role_policy = jsonencode(<span class="token punctuation">{</span> Version = <span class="token" style="color:#f1fa8c">"2012-10-17"</span> Statement = <span class="token punctuation">[</span> <span class="token punctuation">{</span> Action = <span class="token" style="color:#f1fa8c">"sts:AssumeRole"</span> Effect = <span class="token" style="color:#f1fa8c">"Allow"</span> Sid = <span class="token" style="color:#f1fa8c">""</span> Principal = <span class="token punctuation">{</span> Service = <span class="token" style="color:#f1fa8c">"ec2.amazonaws.com"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>) tags = merge( local.base_tags<span class="token punctuation">,</span> <span class="token punctuation">{</span> Name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-s3-role"</span> directory = basename(path.cwd) <span class="token punctuation">}</span><span class="token punctuation">,</span> ) <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">Next we need to create a policy with the aws_iam_policy resource that grants permission to do whatever to the specific bucket we create:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">resource <span class="token" style="color:#f1fa8c">"aws_iam_policy"</span> <span class="token" style="color:#f1fa8c">"s3_policy"</span> <span class="token punctuation">{</span> name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-s3-world-bucket"</span> description = <span class="token" style="color:#f1fa8c">"Policy for access to the world bucket"</span> policy = jsonencode(<span class="token punctuation">{</span> Version = <span class="token" style="color:#f1fa8c">"2012-10-17"</span> Statement = <span class="token punctuation">[</span><span class="token punctuation">{</span> Effect = <span class="token" style="color:#f1fa8c">"Allow"</span> Action = <span class="token" style="color:#f1fa8c">"s3:*"</span> Resource = aws_s<span class="token" style="color:#bd93f9">3</span>_bucket.mc.arn <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>) <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">Then the policy needs to be attached to the role:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">resource <span class="token" style="color:#f1fa8c">"aws_iam_policy_attachment"</span> <span class="token" style="color:#f1fa8c">"s3_policy_attach"</span> <span class="token punctuation">{</span> name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-s3-policy-attachment"</span> roles = <span class="token punctuation">[</span>aws_iam_role.ec<span class="token" style="color:#bd93f9">2</span>_s<span class="token" style="color:#bd93f9">3</span>_access_role.name<span class="token punctuation">]</span> policy_arn = aws_iam_policy.s<span class="token" style="color:#bd93f9">3</span>_policy.arn <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">And because we are doing this programmatically via Terraform, we need to create an instance profile that our EC2 instance will use to assume our new role:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">resource <span class="token" style="color:#f1fa8c">"aws_iam_instance_profile"</span> <span class="token" style="color:#f1fa8c">"ec2_profile"</span> <span class="token punctuation">{</span> name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}-ec2-profile"</span> role = aws_iam_role.ec<span class="token" style="color:#bd93f9">2</span>_s<span class="token" style="color:#bd93f9">3</span>_access_role.name <span class="token punctuation">}</span></code></span></div></div><div class="css-1lyp5n8">Once we have deployed them we can see our role and policy in the console</div><img class="css-1stgykt" src="/static/media/roleWithPolicy.734ffcbf.png"><img class="css-1stgykt" src="/static/media/trustRelationship.e1019464.png"><img class="css-1stgykt" src="/static/media/policyWithRole.a716b5ee.png"><div class="css-1lyp5n8">There's a lot more we could delve into here but this gives us what we need to move on to creating our EC2 instances.</div><br><div class="css-iyq5fi"><h4 class="css-yz2fnm">Create EC2 instances</h4></div><a class="css-3gdh81" href="https://github.com/arthurdayton116/aws-terraform/tree/main/terraform_ec2" target="_blank">Code located here</a><div class="css-1lyp5n8">This part is easy too right up to the point it's not. Making the EC2 instances is simple but the pain lies in the scripts that get executed upon creation and the systemd service that is responsible for managing the fetching and storage of our world directory. Once you get them right it's not bad but getting them to work exactly how you want can be tedious.</div><br><div class="css-1lyp5n8">A lot of stuff comes together in the definition of our public EC2 instance that will run our minecraft server. This image shows the various parts:</div><img class="css-1stgykt" src="/static/media/ec2webserver.77768959.png"><div class="css-1lyp5n8">The file provisioner gives us a way to move our Minecraft.jar file and the service template we will use to sync our instance with our S3 bucket to our EC2 instance.</div><br><div class="css-1lyp5n8">The instance profile gives our EC2 instance the permissions it needs to manage our S3 bucket. The part that ties the whole thing together is the user_data attribute which gives us a means to define a script that will execute upon the creation of our EC2 instance.</div><br><div class="css-1lyp5n8">There is a bunch of stuff going on here but it's all pretty self explanatory:</div><br><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25 </span><span class="react-syntax-highlighter-line-number">26 </span><span class="react-syntax-highlighter-line-number">27 </span><span class="react-syntax-highlighter-line-number">28 </span><span class="react-syntax-highlighter-line-number">29 </span><span class="react-syntax-highlighter-line-number">30 </span><span class="react-syntax-highlighter-line-number">31 </span><span class="react-syntax-highlighter-line-number">32 </span><span class="react-syntax-highlighter-line-number">33 </span><span class="react-syntax-highlighter-line-number">34 </span><span class="react-syntax-highlighter-line-number">35 </span><span class="react-syntax-highlighter-line-number">36 </span><span class="react-syntax-highlighter-line-number">37 </span><span class="react-syntax-highlighter-line-number">38 </span><span class="react-syntax-highlighter-line-number">39 </span><span class="react-syntax-highlighter-line-number">40 </span><span class="react-syntax-highlighter-line-number">41 </span><span class="react-syntax-highlighter-line-number">42 </span><span class="react-syntax-highlighter-line-number">43 </span><span class="react-syntax-highlighter-line-number">44 </span><span class="react-syntax-highlighter-line-number">45 </span><span class="react-syntax-highlighter-line-number">46 </span><span class="react-syntax-highlighter-line-number">47 </span><span class="react-syntax-highlighter-line-number">48 </span><span class="react-syntax-highlighter-line-number">49 </span><span class="react-syntax-highlighter-line-number">50 </span><span class="react-syntax-highlighter-line-number">51 </span><span class="react-syntax-highlighter-line-number">52 </span><span class="react-syntax-highlighter-line-number">53 </span><span class="react-syntax-highlighter-line-number">54 </span><span class="react-syntax-highlighter-line-number">55 </span><span class="react-syntax-highlighter-line-number">56 </span><span class="react-syntax-highlighter-line-number">57 </span><span class="react-syntax-highlighter-line-number">58 </span><span class="react-syntax-highlighter-line-number">59 </span><span class="react-syntax-highlighter-line-number">60 </span><span class="react-syntax-highlighter-line-number">61 </span><span class="react-syntax-highlighter-line-number">62 </span><span class="react-syntax-highlighter-line-number">63 </span><span class="react-syntax-highlighter-line-number">64</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px"><span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">#!/bin/sh</span> <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic"># check logs</span> <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic"># /var/log/cloud-init.log and</span> <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic"># /var/log/cloud-init-output.log</span> <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">### Updates and installs</span> <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">apt-get</span> update -y <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">apt-get</span> <span class="token" style="color:#50fa7b">install</span> <span class="token" style="color:#50fa7b">wget</span> <span class="token" style="color:#50fa7b">screen</span> default-jdk nmap -y <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">apt</span> <span class="token" style="color:#50fa7b">install</span> awscli -y <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">### Create directories for minecraft</span> <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">mkdir</span> /opt/ubuntu <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">mkdir</span> /opt/ubuntu/willmc <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">chown</span> -R ubuntu:ubuntu /opt/ubuntu/willmc/ <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">### Check if our bucket has anything in it</span> <span class="token assign-left" style="color:#f8f8f2">list</span><span class="token operator">=</span><span class="token" style="color:#f8f8f2"><span class="token" style="color:#f8f8f2">$(</span>aws s3 <span class="token" style="color:#50fa7b">ls</span> s3://sample-company-bucket/mcBackup/<span class="token" style="color:#f8f8f2">)</span></span> <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">### If it does sync it to our EC2 instance and delete any lock files else do first time setup</span> <span class="token" style="color:#ff79c6;font-weight:bolder">if</span> <span class="token" style="color:#f8f8f2">echo</span> <span class="token" style="color:#f8f8f2">$list</span> <span class="token operator">|</span><span class="token" style="color:#50fa7b">grep</span> -wc <span class="token" style="color:#f1fa8c">"world/"</span> <span class="token punctuation">;</span> <span class="token" style="color:#ff79c6;font-weight:bolder">then</span> aws s3 <span class="token" style="color:#50fa7b">sync</span> s3://sample-company-bucket/mcBackup /opt/ubuntu/willmc <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">rm</span> -f /opt/ubuntu/willmcworld/session.lock <span class="token" style="color:#ff79c6;font-weight:bolder">else</span> <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">## Sets eula for minecraft</span> <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">bash</span> -c <span class="token" style="color:#f1fa8c">"echo eula=true > /opt/ubuntu/willmc/eula.txt"</span> <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">## Copy minecraft jar to run directory</span> <span class="token" style="color:#50fa7b">cp</span> /home/ubuntu/mc_16_4_server.jar /opt/ubuntu/willmc/mc_16_4_server.jar <span class="token" style="color:#ff79c6;font-weight:bolder">fi</span> <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">### Make sure Ubuntu user owns it</span> <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">chown</span> -R ubuntu:ubuntu /opt/ubuntu/willmc/ <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">### Create shutdown script that will sync results of kiddies changes to their world back to S3</span> <span class="token" style="color:#f8f8f2">echo</span> <span class="token" style="color:#f1fa8c">"aws s3 sync /opt/ubuntu/willmc s3://sample-company-bucket/mcBackup"</span> <span class="token operator">></span> /opt/ubuntu/willmc/shutdown.sh <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">chmod</span> uga+x /opt/ubuntu/willmc/shutdown.sh <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">### Make sure it is executable</span> <span class="token" style="color:#50fa7b">chmod</span> uga+x /opt/ubuntu/willmc/mc_16_4_server.jar <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">### Create service for autostart of Minecraft server whenever instance starts/reboots</span> <span class="token" style="color:#50fa7b">sudo</span> <span class="token" style="color:#50fa7b">cp</span> /home/ubuntu/minecraft@.service /etc/systemd/system/minecraft@.service <span class="token" style="color:#50fa7b">sudo</span> systemctl start minecraft@willmc <span class="token" style="color:#50fa7b">sudo</span> systemctl status minecraft@willmc <span class="token" style="color:#50fa7b">sudo</span> systemctl <span class="token" style="color:#f8f8f2">enable</span> minecraft@willmc <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">### Enable firewall and open ports for Minecraft, SSH and Apache</span> <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic"># https://wiki.ubuntu.com/UncomplicatedFirewall</span> <span class="token" style="color:#50fa7b">sudo</span> ufw <span class="token" style="color:#f8f8f2">enable</span> <span class="token" style="color:#50fa7b">sudo</span> ufw allow <span class="token" style="color:#bd93f9">25565</span>/tcp <span class="token" style="color:#50fa7b">sudo</span> ufw allow <span class="token" style="color:#bd93f9">22</span>/tcp <span class="token" style="color:#50fa7b">sudo</span> ufw allow <span class="token" style="color:#bd93f9">80</span>/tcp <span class="token" style="color:#6272a4;font-family:inherit;font-style:italic">### Install apache for endpoint check and echo some simple HTML into an index file</span> <span class="token" style="color:#50fa7b">apt-get</span> <span class="token" style="color:#50fa7b">install</span> -y apache2 <span class="token" style="color:#50fa7b">service</span> start apache2 <span class="token" style="color:#50fa7b">chkconfig</span> apache2 on <span class="token assign-left" style="color:#f8f8f2">instanceid</span><span class="token operator">=</span><span class="token" style="color:#f1fa8c">"<span class="token" style="color:#f8f8f2"><span class="token" style="color:#f8f8f2">$(</span><span class="token" style="color:#50fa7b">curl</span> -s -H <span class="token" style="color:#f1fa8c">"X-aws-ec2-metadata-token: <span class="token" style="color:#f8f8f2">$TOKEN</span>"</span> -v http://169.254.169.254/latest/meta-data/instance-id <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null<span class="token" style="color:#f8f8f2">)</span></span>"</span> <span class="token" style="color:#f8f8f2">echo</span> <span class="token" style="color:#f1fa8c">"&lt;html>"</span> <span class="token operator">></span> /var/www/html/index.html <span class="token" style="color:#f8f8f2">echo</span> <span class="token" style="color:#f1fa8c">"&lt;h1>Welcome to Apache Web Server&lt;/h1>"</span> <span class="token operator">>></span> /var/www/html/index.html <span class="token" style="color:#f8f8f2">echo</span> <span class="token" style="color:#f1fa8c">"&lt;h2>Created using Terraform&lt;/h2>"</span> <span class="token operator">>></span> /var/www/html/index.html <span class="token" style="color:#f8f8f2">echo</span> <span class="token" style="color:#f1fa8c">"&lt;h4>Instance ID=<span class="token" style="color:#f8f8f2">$instanceid</span>&lt;/h4>"</span> <span class="token operator">>></span> /var/www/html/index.html <span class="token" style="color:#f8f8f2">echo</span> <span class="token" style="color:#f1fa8c">"&lt;/html>"</span> <span class="token operator">>></span> /var/www/html/index.html</code></span></div></div><br><div class="css-1lyp5n8">The next piece of magic is the service template. The two important parts are the ExecStart which tells it to start Minecraft when our server starts and the all important 4th ExecStop that says run the script that will sync your world back to S3 before we unceremoniously deleting this server.</div><br><img class="css-1stgykt" src="/static/media/ServiceFile.725f61cb.png"><br><div class="css-1lyp5n8">After I watched my 8 year old rage quit Minecraft for life over apparently losing all his diamonds (whatever that means), and then proceed to start playing again in less than 15 minutes, I thought about turning on versioning for my S3 bucket. But then I thought what kind of life lesson would I be teaching him by not letting him suffer the consequences of his actions? So suck it up little one, as survival mode makes abundantly clear, life is hard. But, if you don't subscribe to my baby shark parenting style, know that it is possible to version the files you are syncing back to S3 in case something goes awry and you need to back up to previous version of your world state.</div><br><div class="css-1lyp5n8">Looking at our Terraform folder the last part that I'm really concerned with is limiting who can get to our server. To do that I define a security group in the ec2_security_group.tf:</div><img class="css-1stgykt" src="/static/media/tf_folder.8dcc53cb.png"><div class="css-1lyp5n8">We want to avoid leaving our server open to the whole world by setting up ingress rules that have bits like this:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">cidr_blocks = <span class="token punctuation">[</span><span class="token" style="color:#f1fa8c">"0.0.0.0/0"</span><span class="token punctuation">]</span></code></span></div></div><br><div class="css-1lyp5n8">so for our Minecraft server we will limit access to our local IP (you don't need 22 or 80 for Minecraft). The chomp part should put your public ip in the cidr_blocks, if you are running everything local, and you can obviously put an array of whatever IP's you want in there:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25 </span><span class="react-syntax-highlighter-line-number">26 </span><span class="react-syntax-highlighter-line-number">27 </span><span class="react-syntax-highlighter-line-number">28 </span><span class="react-syntax-highlighter-line-number">29 </span><span class="react-syntax-highlighter-line-number">30 </span><span class="react-syntax-highlighter-line-number">31 </span><span class="react-syntax-highlighter-line-number">32 </span><span class="react-syntax-highlighter-line-number">33 </span><span class="react-syntax-highlighter-line-number">34</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">resource <span class="token" style="color:#f1fa8c">"aws_security_group"</span> <span class="token" style="color:#f1fa8c">"ec2_public"</span> <span class="token punctuation">{</span> name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}_ec2"</span> vpc_id = data.terraform_remote_state.vpc.outputs.vpc_id ingress <span class="token punctuation">{</span> from_port = <span class="token" style="color:#bd93f9">22</span> to_port = <span class="token" style="color:#bd93f9">22</span> protocol = <span class="token" style="color:#f1fa8c">"tcp"</span> cidr_blocks = <span class="token punctuation">[</span><span class="token" style="color:#f1fa8c">"${chomp(data.http.myip.body)}/32"</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> ingress <span class="token punctuation">{</span> from_port = <span class="token" style="color:#bd93f9">80</span> to_port = <span class="token" style="color:#bd93f9">80</span> protocol = <span class="token" style="color:#f1fa8c">"tcp"</span> cidr_blocks = <span class="token punctuation">[</span><span class="token" style="color:#f1fa8c">"${chomp(data.http.myip.body)}/32"</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> ingress <span class="token punctuation">{</span> from_port = <span class="token" style="color:#bd93f9">25565</span> to_port = <span class="token" style="color:#bd93f9">25565</span> protocol = <span class="token" style="color:#f1fa8c">"tcp"</span> cidr_blocks = <span class="token punctuation">[</span><span class="token" style="color:#f1fa8c">"${chomp(data.http.myip.body)}/32"</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> egress <span class="token punctuation">{</span> from_port = <span class="token" style="color:#bd93f9">0</span> to_port = <span class="token" style="color:#bd93f9">0</span> protocol = <span class="token" style="color:#f1fa8c">"-1"</span> cidr_blocks = <span class="token punctuation">[</span><span class="token" style="color:#f1fa8c">"0.0.0.0/0"</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> tags = merge( local.base_tags<span class="token punctuation">,</span> <span class="token punctuation">{</span> Name = <span class="token" style="color:#f1fa8c">"${local.resource_prefix}_ec2"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> ) <span class="token punctuation">}</span></code></span></div></div><br><div class="css-1lyp5n8">Finally, we are ready to deploy this thing and bask in the glory of our creation. My 12 year old is convinced I'd have been done hours ago if I just read some stupid blog entry he found but he's to young to understand why the person who wrote that is clearly an idiot and has no idea how to properly over engineer something.</div><br><div class="css-1lyp5n8">Assuming you have your VPC</div><img class="css-1stgykt" src="/static/media/vpc_outputs.71dfe3d8.png"><div class="css-1lyp5n8">and your S3 bucket deployed</div><img class="css-1stgykt" src="/static/media/s3_outputs.bdf269f4.png"><div class="css-1lyp5n8">you should have the outputs stored in their respective state files that will allow us to successfully run terraform apply on our terraform_ec2 directory:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25 </span><span class="react-syntax-highlighter-line-number">26 </span><span class="react-syntax-highlighter-line-number">27 </span><span class="react-syntax-highlighter-line-number">28 </span><span class="react-syntax-highlighter-line-number">29 </span><span class="react-syntax-highlighter-line-number">30 </span><span class="react-syntax-highlighter-line-number">31 </span><span class="react-syntax-highlighter-line-number">32 </span><span class="react-syntax-highlighter-line-number">33 </span><span class="react-syntax-highlighter-line-number">34</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px"><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>terraform apply -auto-approve </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_key_pair.ec</span><span class="token" style="color:#bd93f9">2</span><span>key</span><span class="token operator">:</span><span> Creating... </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_security_group.ec</span><span class="token" style="color:#bd93f9">2</span><span>_private</span><span class="token operator">:</span><span> Creating... </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_security_group.ec</span><span class="token" style="color:#bd93f9">2</span><span>_public</span><span class="token operator">:</span><span> Creating... </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_key_pair.ec</span><span class="token" style="color:#bd93f9">2</span><span>key</span><span class="token operator">:</span><span> Creation complete after </span><span class="token" style="color:#bd93f9">1</span><span>s </span><span class="token punctuation">[</span><span>id=sample-company_publicKey</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_security_group.ec</span><span class="token" style="color:#bd93f9">2</span><span>_private</span><span class="token operator">:</span><span> Creation complete after </span><span class="token" style="color:#bd93f9">2</span><span>s </span><span class="token punctuation">[</span><span>id=sg</span><span class="token" style="color:#bd93f9">-056</span><span>c</span><span class="token" style="color:#bd93f9">29</span><span>f</span><span class="token" style="color:#bd93f9">273</span><span>b</span><span class="token" style="color:#bd93f9">591</span><span>cbc</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token" style="color:#bd93f9">2</span><span class="token operator">:</span><span> Creating... </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_security_group.ec</span><span class="token" style="color:#bd93f9">2</span><span>_public</span><span class="token operator">:</span><span> Creation complete after </span><span class="token" style="color:#bd93f9">2</span><span>s </span><span class="token punctuation">[</span><span>id=sg</span><span class="token" style="color:#bd93f9">-0</span><span>bc</span><span class="token" style="color:#bd93f9">194e10</span><span>e</span><span class="token" style="color:#bd93f9">0</span><span>a</span><span class="token" style="color:#bd93f9">1</span><span>b</span><span class="token" style="color:#bd93f9">1</span><span>fe</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token operator">:</span><span> Creating... </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token" style="color:#bd93f9">2</span><span class="token operator">:</span><span> Still creating... </span><span class="token punctuation">[</span><span class="token" style="color:#bd93f9">10</span><span>s elapsed</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token operator">:</span><span> Still creating... </span><span class="token punctuation">[</span><span class="token" style="color:#bd93f9">10</span><span>s elapsed</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token operator">:</span><span> Provisioning with 'file'... </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token" style="color:#bd93f9">2</span><span class="token operator">:</span><span> Still creating... </span><span class="token punctuation">[</span><span class="token" style="color:#bd93f9">20</span><span>s elapsed</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token operator">:</span><span> Still creating... </span><span class="token punctuation">[</span><span class="token" style="color:#bd93f9">20</span><span>s elapsed</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token" style="color:#bd93f9">2</span><span class="token operator">:</span><span> Creation complete after </span><span class="token" style="color:#bd93f9">22</span><span>s </span><span class="token punctuation">[</span><span>id=i</span><span class="token" style="color:#bd93f9">-0</span><span>af</span><span class="token" style="color:#bd93f9">98772</span><span>d</span><span class="token" style="color:#bd93f9">68</span><span>da</span><span class="token" style="color:#bd93f9">2</span><span>ae</span><span class="token" style="color:#bd93f9">2</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token operator">:</span><span> Still creating... </span><span class="token punctuation">[</span><span class="token" style="color:#bd93f9">30</span><span>s elapsed</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token operator">:</span><span> Provisioning with 'file'... </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_instance.web</span><span class="token operator">:</span><span> Creation complete after </span><span class="token" style="color:#bd93f9">39</span><span>s </span><span class="token punctuation">[</span><span>id=i</span><span class="token" style="color:#bd93f9">-071</span><span>d</span><span class="token" style="color:#bd93f9">7600670</span><span>c</span><span class="token" style="color:#bd93f9">59383</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_eip_association.eip_assoc</span><span class="token operator">:</span><span> Creating... </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>aws_eip_association.eip_assoc</span><span class="token operator">:</span><span> Creation complete after </span><span class="token" style="color:#bd93f9">1</span><span>s </span><span class="token punctuation">[</span><span>id=eipassoc</span><span class="token" style="color:#bd93f9">-0768156</span><span>bed</span><span class="token" style="color:#bd93f9">17736</span><span>c</span><span class="token" style="color:#bd93f9">0</span><span class="token punctuation">]</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>Apply complete! Resources</span><span class="token operator">:</span><span> </span><span class="token" style="color:#bd93f9">6</span><span> added</span><span class="token punctuation">,</span><span> </span><span class="token" style="color:#bd93f9">0</span><span> changed</span><span class="token punctuation">,</span><span> </span><span class="token" style="color:#bd93f9">0</span><span> destroyed. </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>Outputs</span><span class="token operator">:</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>copy_private_key_to_ec</span><span class="token" style="color:#bd93f9">2</span><span> = </span><span class="token" style="color:#f1fa8c">"scp -i ~/.ssh/id_rsa_ec2 ~/.ssh/id_rsa_ec2 ubuntu@44.239.221.41:~/.ssh/id_rsa_ec2"</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>curl_local_host = </span><span class="token" style="color:#f1fa8c">"curl http://localhost"</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>curl_private_host = </span><span class="token" style="color:#f1fa8c">"curl http://10.1.1.126"</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>key_id = </span><span class="token" style="color:#f1fa8c">"sample-company_publicKey"</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>key_name = </span><span class="token" style="color:#f1fa8c">"sample-company_publicKey"</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>private_ssh_link = </span><span class="token" style="color:#f1fa8c">"ssh -i ~/.ssh/id_rsa_ec2 ubuntu@10.1.1.126"</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>public_ssh_link = </span><span class="token" style="color:#f1fa8c">"ssh -i ~/.ssh/id_rsa_ec2 ubuntu@44.239.221.41"</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>webserver_ip = </span><span class="token" style="color:#f1fa8c">"44.239.221.41"</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>webserver_link = </span><span class="token" style="color:#f1fa8c">"http://44.239.221.41"</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"></span></code></span></div></div><br><div class="css-1lyp5n8">The outputs should give us all the connection strings we need to test it.</div><br><div class="css-1lyp5n8">The public ssh should get you right in to your public instance while the private one should fail from your local machine but work fine from within your public instance ()after you copy a private key to the public instance):</div><br><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">➜ terraform_ec2 git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ <span class="token" style="color:#50fa7b">ssh</span> -i ~/.ssh/id_rsa_ec2 ubuntu@10.1.1.236 ssh: connect to <span class="token" style="color:#50fa7b">host</span> <span class="token" style="color:#bd93f9">10.1</span>.1.236 port <span class="token" style="color:#bd93f9">22</span>: Network is unreachable</code></span></div></div><br><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22 </span><span class="react-syntax-highlighter-line-number">23 </span><span class="react-syntax-highlighter-line-number">24 </span><span class="react-syntax-highlighter-line-number">25 </span><span class="react-syntax-highlighter-line-number">26 </span><span class="react-syntax-highlighter-line-number">27 </span><span class="react-syntax-highlighter-line-number">28 </span><span class="react-syntax-highlighter-line-number">29</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px"><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>copy_private_key_to_ec2 </span><span class="token operator">=</span><span> </span><span class="token" style="color:#f1fa8c">"scp -i ~/.ssh/id_rsa_ec2 ~/.ssh/id_rsa_ec2 ubuntu@52.88.116.72:~/.ssh/id_rsa_ec2"</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>curl_local_host </span><span class="token operator">=</span><span> </span><span class="token" style="color:#f1fa8c">"curl http://localhost"</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>curl_private_host </span><span class="token operator">=</span><span> </span><span class="token" style="color:#f1fa8c">"curl http://10.1.1.240"</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>key_id </span><span class="token operator">=</span><span> </span><span class="token" style="color:#f1fa8c">"sample-company_publicKey"</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>key_name </span><span class="token operator">=</span><span> </span><span class="token" style="color:#f1fa8c">"sample-company_publicKey"</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>private_ssh_link </span><span class="token operator">=</span><span> </span><span class="token" style="color:#f1fa8c">"ssh -i ~/.ssh/id_rsa_ec2 ubuntu@10.1.1.240"</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>public_ssh_link </span><span class="token operator">=</span><span> </span><span class="token" style="color:#f1fa8c">"ssh -i ~/.ssh/id_rsa_ec2 ubuntu@52.88.116.72"</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>webserver_ip </span><span class="token operator">=</span><span> </span><span class="token" style="color:#f1fa8c">"52.88.116.72"</span><span> </span></span><span style="opacity:.3;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>webserver_link </span><span class="token operator">=</span><span> </span><span class="token" style="color:#f1fa8c">"http://52.88.116.72"</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>➜ terraform_ec2 git:</span><span class="token punctuation">(</span><span>main</span><span class="token punctuation">)</span><span> ✗ </span><span class="token" style="color:#50fa7b">scp</span><span> -i ~/.ssh/id_rsa_ec2 ~/.ssh/id_rsa_ec2 ubuntu@52.88.116.72:~/.ssh/id_rsa_ec2 </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>id_rsa_ec2 </span><span class="token" style="color:#bd93f9">100</span><span>% </span><span class="token" style="color:#bd93f9">2622</span><span> </span><span class="token" style="color:#bd93f9">195</span><span>.4KB/s 00:00 </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>➜ terraform_ec2 git:</span><span class="token punctuation">(</span><span>main</span><span class="token punctuation">)</span><span> ✗ </span><span class="token" style="color:#50fa7b">ssh</span><span> -i ~/.ssh/id_rsa_ec2 ubuntu@52.88.116.72 </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>ubuntu@ip-10-1-0-10:~$ </span><span class="token" style="color:#50fa7b">ssh</span><span> -i ~/.ssh/id_rsa_ec2 ubuntu@10.1.1.240 </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>ubuntu@ip-10-1-1-240:~$ </span><span class="token" style="color:#50fa7b">curl</span><span> http://localhost </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token operator">&lt;</span><span>html</span><span class="token operator">></span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token operator">&lt;</span><span>h</span><span class="token operator token file-descriptor important">1</span><span class="token operator">></span><span>Welcome to Apache Web Server</span><span class="token operator">&lt;</span><span>/h</span><span class="token operator token file-descriptor important">1</span><span class="token operator">></span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token operator">&lt;</span><span>h</span><span class="token operator token file-descriptor important">2</span><span class="token operator">></span><span>Created using Terraform</span><span class="token operator">&lt;</span><span>/h</span><span class="token operator token file-descriptor important">2</span><span class="token operator">></span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token operator">&lt;</span><span>h</span><span class="token operator token file-descriptor important">4</span><span class="token operator">></span><span>Instance </span><span class="token assign-left" style="color:#f8f8f2">ID</span><span class="token operator">=</span><span>i-04bde504b37f90be</span><span class="token operator token file-descriptor important">6</span><span class="token operator">&lt;</span><span>/h</span><span class="token operator token file-descriptor important">4</span><span class="token operator">></span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token operator">&lt;</span><span>/html</span><span class="token operator">></span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>ubuntu@ip-10-1-1-240:~$ </span><span class="token" style="color:#f8f8f2">exit</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token" style="color:#f8f8f2">logout</span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>Connection to </span><span class="token" style="color:#bd93f9">10.1</span><span>.1.240 closed. </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span>ubuntu@ip-10-1-0-10:~$ </span><span class="token" style="color:#50fa7b">curl</span><span> http://10.1.1.240 </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token operator">&lt;</span><span>html</span><span class="token operator">></span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token operator">&lt;</span><span>h</span><span class="token operator token file-descriptor important">1</span><span class="token operator">></span><span>Welcome to Apache Web Server</span><span class="token operator">&lt;</span><span>/h</span><span class="token operator token file-descriptor important">1</span><span class="token operator">></span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token operator">&lt;</span><span>h</span><span class="token operator token file-descriptor important">2</span><span class="token operator">></span><span>Created using Terraform</span><span class="token operator">&lt;</span><span>/h</span><span class="token operator token file-descriptor important">2</span><span class="token operator">></span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token operator">&lt;</span><span>h</span><span class="token operator token file-descriptor important">4</span><span class="token operator">></span><span>Instance </span><span class="token assign-left" style="color:#f8f8f2">ID</span><span class="token operator">=</span><span>i-04bde504b37f90be</span><span class="token operator token file-descriptor important">6</span><span class="token operator">&lt;</span><span>/h</span><span class="token operator token file-descriptor important">4</span><span class="token operator">></span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"><span></span><span class="token operator">&lt;</span><span>/html</span><span class="token operator">></span><span> </span></span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none">ubuntu@ip-10-1-0-10:~$ </span><span style="opacity:1;font-size:inherit;line-height:1.42857;color:#6272a4;background-color:#282a36;flex-shrink:0;padding:8px;text-align:right;user-select:none"></span></code></span></div></div><br><div class="css-1lyp5n8">We prove out our connectivity and the success of our Apache install by showing we can ssh into our private instance and curl our simple index file. That proves the NAT gateway we set up in our VPC allowed our private instance to reach out to the internet for its software installs. A quick check in the browser shows we have successfully installed and routed our public Apache instance:</div><br><img class="css-1stgykt" src="/static/media/Browser_Apache.41a0210d.png"><br><div class="css-1lyp5n8">and now we can check our Minecraft server status and see if my latest instance of a server has inherited files from the S3 bucket:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">ubuntu@ip-10-1-0-10:/opt/ubuntu/willmc$ <span class="token" style="color:#50fa7b">ls</span> banned-ips.json banned-players.json eula.txt logs mc_16_4_server.jar ops.json server.properties shutdown.sh usercache.json whitelist.json world ubuntu@ip-10-1-0-10:/opt/ubuntu/willmc$ <span class="token" style="color:#50fa7b">sudo</span> systemctl status minecraft@willmc ● minecraft@willmc.service - Minecraft Server: willmc Loaded: loaded <span class="token punctuation">(</span>/etc/systemd/system/minecraft@.service<span class="token punctuation">;</span> indirect<span class="token punctuation">;</span> vendor preset: enabled<span class="token punctuation">)</span> Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since Wed <span class="token" style="color:#bd93f9">2021</span>-03-03 05:44:26 UTC<span class="token punctuation">;</span> 1min 16s ago Main PID: <span class="token" style="color:#bd93f9">9966</span> <span class="token punctuation">(</span>screen<span class="token punctuation">)</span> Tasks: <span class="token" style="color:#bd93f9">32</span> <span class="token punctuation">(</span>limit: <span class="token" style="color:#bd93f9">4686</span><span class="token punctuation">)</span> CGroup: /system.slice/system-minecraft.slice/minecraft@willmc.service ├─9966 /usr/bin/SCREEN -DmS mc-willmc /usr/bin/java -Xmx2G -jar mc_16_4_server.jar nogui └─9981 /usr/bin/java -Xmx2G -jar mc_16_4_server.jar nogui Mar 03 05:44:26 ip-10-1-0-10 systemd<span class="token punctuation">[</span><span class="token" style="color:#bd93f9">1</span><span class="token punctuation">]</span>: Started Minecraft Server: willmc. ubuntu@ip-10-1-0-10:/opt/ubuntu/willmc$</code></span></div></div><br><div class="css-1lyp5n8">It's up and alive and we can see a big set of files were apparently copied over. If you have any doubts about what happened during startup you can check the logs:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">ubuntu@ip-10-1-0-10:/opt/ubuntu/willmc$ <span class="token" style="color:#f8f8f2">cd</span> /var/log/ ubuntu@ip-10-1-0-10:/var/log$ <span class="token" style="color:#50fa7b">ls</span> alternatives.log apache2 auth.log cloud-init-output.log dist-upgrade fontconfig.log kern.log lastlog syslog unattended-upgrades amazon <span class="token" style="color:#50fa7b">apt</span> btmp cloud-init.log dpkg.log journal landscape lxd tallylog wtmp ubuntu@ip-10-1-0-10:/var/log$ <span class="token" style="color:#50fa7b">vi</span> cloud-init-output.log</code></span></div></div><div class="css-1lyp5n8">For proof that our sync back to S3 works we can create a file in the /opt/ubuntu/willmc directory and then destroy our instance. If it works we should see our file in S3 (you could also play Minecraft) after our instance is destroyed:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">ubuntu@ip-10-1-0-10:/var/log$ <span class="token" style="color:#f8f8f2">cd</span> /opt/ubuntu/willmc/ ubuntu@ip-10-1-0-10:/opt/ubuntu/willmc$ <span class="token" style="color:#50fa7b">ls</span> banned-ips.json banned-players.json eula.txt logs mc_16_4_server.jar ops.json server.properties shutdown.sh usercache.json whitelist.json world ubuntu@ip-10-1-0-10:/opt/ubuntu/willmc$ <span class="token" style="color:#f8f8f2">echo</span> <span class="token" style="color:#f1fa8c">"This proves it!!!!!!"</span> <span class="token operator">></span> proof.txt <span class="token" style="color:#f8f8f2">echo</span> <span class="token" style="color:#f1fa8c">"This proves itlslsls"</span> <span class="token operator">></span> proof.txt ubuntu@ip-10-1-0-10:/opt/ubuntu/willmc$ <span class="token" style="color:#50fa7b">ls</span> banned-ips.json banned-players.json eula.txt logs mc_16_4_server.jar ops.json proof.txt server.properties shutdown.sh usercache.json whitelist.json world ubuntu@ip-10-1-0-10:/opt/ubuntu/willmc$</code></span></div></div><br><div class="css-1lyp5n8">Checking our S3 bucket before we see :</div><img class="css-1stgykt" src="/static/media/s3WithFiles.693f84a9.png"><div class="css-1lyp5n8">Now gently eradicate our server:</div><div><div class="css-1uzs5fn"><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.42857;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px 10px 8px 8px;float:left"><span class="react-syntax-highlighter-line-number">1 </span><span class="react-syntax-highlighter-line-number">2 </span><span class="react-syntax-highlighter-line-number">3 </span><span class="react-syntax-highlighter-line-number">4 </span><span class="react-syntax-highlighter-line-number">5 </span><span class="react-syntax-highlighter-line-number">6 </span><span class="react-syntax-highlighter-line-number">7 </span><span class="react-syntax-highlighter-line-number">8 </span><span class="react-syntax-highlighter-line-number">9 </span><span class="react-syntax-highlighter-line-number">10 </span><span class="react-syntax-highlighter-line-number">11 </span><span class="react-syntax-highlighter-line-number">12 </span><span class="react-syntax-highlighter-line-number">13 </span><span class="react-syntax-highlighter-line-number">14 </span><span class="react-syntax-highlighter-line-number">15 </span><span class="react-syntax-highlighter-line-number">16 </span><span class="react-syntax-highlighter-line-number">17 </span><span class="react-syntax-highlighter-line-number">18 </span><span class="react-syntax-highlighter-line-number">19 </span><span class="react-syntax-highlighter-line-number">20 </span><span class="react-syntax-highlighter-line-number">21 </span><span class="react-syntax-highlighter-line-number">22</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.66667;padding:8px">terraform_ec<span class="token" style="color:#bd93f9">2</span> git<span class="token operator">:</span>(main) ✗ terraform destroy -auto-approve aws_eip_association.eip_assoc<span class="token operator">:</span> Destroying... <span class="token punctuation">[</span>id=eipassoc<span class="token" style="color:#bd93f9">-078</span>c<span class="token" style="color:#bd93f9">38</span>f<span class="token" style="color:#bd93f9">9e56</span>ba<span class="token" style="color:#bd93f9">06</span>a<span class="token" style="color:#bd93f9">1</span><span class="token punctuation">]</span> aws_instance.web<span class="token" style="color:#bd93f9">2</span><span class="token operator">:</span> Destroying... <span class="token punctuation">[</span>id=i<span class="token" style="color:#bd93f9">-0</span>f<span class="token" style="color:#bd93f9">25</span>f<span class="token" style="color:#bd93f9">3</span>c<span class="token" style="color:#bd93f9">362</span>d<span class="token" style="color:#bd93f9">883891</span><span class="token punctuation">]</span> aws_eip_association.eip_assoc<span class="token operator">:</span> Destruction complete after <span class="token" style="color:#bd93f9">1</span>s aws_instance.web<span class="token operator">:</span> Destroying... <span class="token punctuation">[</span>id=i<span class="token" style="color:#bd93f9">-053</span>edeb<span class="token" style="color:#bd93f9">44</span>ecce<span class="token" style="color:#bd93f9">49</span>b<span class="token" style="color:#bd93f9">3</span><span class="token punctuation">]</span> aws_instance.web<span class="token" style="color:#bd93f9">2</span><span class="token operator">:</span> Still destroying... <span class="token punctuation">[</span>id=i<span class="token" style="color:#bd93f9">-0</span>f<span class="token" style="color:#bd93f9">25</span>f<span class="token" style="color:#bd93f9">3</span>c<span class="token" style="color:#bd93f9">362</span>d<span class="token" style="color:#bd93f9">883891</span><span class="token punctuation">,</span> <span class="token" style="color:#bd93f9">10</span>s elapsed<span class="token punctuation">]</span> aws_instance.web<span class="token operator">:</span> Still destroying... <span class="token punctuation">[</span>id=i<span class="token" style="color:#bd93f9">-053</span>edeb<span class="token" style="color:#bd93f9">44</span>ecce<span class="token" style="color:#bd93f9">49</span>b<span class="token" style="color:#bd93f9">3</span><span class="token punctuation">,</span> <span class="token" style="color:#bd93f9">10</span>s elapsed<span class="token punctuation">]</span> aws_instance.web<span class="token" style="color:#bd93f9">2</span><span class="token operator">:</span> Still destroying... <span class="token punctuation">[</span>id=i<span class="token" style="color:#bd93f9">-0</span>f<span class="token" style="color:#bd93f9">25</span>f<span class="token" style="color:#bd93f9">3</span>c<span class="token" style="color:#bd93f9">362</span>d<span class="token" style="color:#bd93f9">883891</span><span class="token punctuation">,</span> <span class="token" style="color:#bd93f9">20</span>s elapsed<span class="token punctuation">]</span> aws_instance.web<span class="token operator">:</span> Still destroying... <span class="token punctuation">[</span>id=i<span class="token" style="color:#bd93f9">-053</span>edeb<span class="token" style="color:#bd93f9">44</span>ecce<span class="token" style="color:#bd93f9">49</span>b<span class="token" style="color:#bd93f9">3</span><span class="token punctuation">,</span> <span class="token" style="color:#bd93f9">20</span>s elapsed<span class="token punctuation">]</span> aws_instance.web<span class="token" style="color:#bd93f9">2</span><span class="token operator">:</span> Still destroying... <span class="token punctuation">[</span>id=i<span class="token" style="color:#bd93f9">-0</span>f<span class="token" style="color:#bd93f9">25</span>f<span class="token" style="color:#bd93f9">3</span>c<span class="token" style="color:#bd93f9">362</span>d<span class="token" style="color:#bd93f9">883891</span><span class="token punctuation">,</span> <span class="token" style="color:#bd93f9">30</span>s elapsed<span class="token punctuation">]</span> aws_instance.web<span class="token" style="color:#bd93f9">2</span><span class="token operator">:</span> Destruction complete after <span class="token" style="color:#bd93f9">30</span>s aws_security_group.ec<span class="token" style="color:#bd93f9">2</span>_private<span class="token operator">:</span> Destroying... <span class="token punctuation">[</span>id=sg<span class="token" style="color:#bd93f9">-0e95</span>bea<span class="token" style="color:#bd93f9">130</span>aaf<span class="token" style="color:#bd93f9">9617</span><span class="token punctuation">]</span> aws_security_group.ec<span class="token" style="color:#bd93f9">2</span>_private<span class="token operator">:</span> Destruction complete after <span class="token" style="color:#bd93f9">1</span>s aws_instance.web<span class="token operator">:</span> Still destroying... <span class="token punctuation">[</span>id=i<span class="token" style="color:#bd93f9">-053</span>edeb<span class="token" style="color:#bd93f9">44</span>ecce<span class="token" style="color:#bd93f9">49</span>b<span class="token" style="color:#bd93f9">3</span><span class="token punctuation">,</span> <span class="token" style="color:#bd93f9">30</span>s elapsed<span class="token punctuation">]</span> aws_instance.web<span class="token operator">:</span> Destruction complete after <span class="token" style="color:#bd93f9">31</span>s aws_key_pair.ec<span class="token" style="color:#bd93f9">2</span>key<span class="token operator">:</span> Destroying... <span class="token punctuation">[</span>id=sample-company_publicKey<span class="token punctuation">]</span> aws_security_group.ec<span class="token" style="color:#bd93f9">2</span>_public<span class="token operator">:</span> Destroying... <span class="token punctuation">[</span>id=sg<span class="token" style="color:#bd93f9">-04</span>ef<span class="token" style="color:#bd93f9">77127230486</span>df<span class="token punctuation">]</span> aws_key_pair.ec<span class="token" style="color:#bd93f9">2</span>key<span class="token operator">:</span> Destruction complete after <span class="token" style="color:#bd93f9">0</span>s aws_security_group.ec<span class="token" style="color:#bd93f9">2</span>_public<span class="token operator">:</span> Destruction complete after <span class="token" style="color:#bd93f9">1</span>s Destroy complete! Resources<span class="token operator">:</span> <span class="token" style="color:#bd93f9">6</span> destroyed. ➜ terraform_ec<span class="token" style="color:#bd93f9">2</span> git<span class="token operator">:</span>(main) ✗</code></span></div></div><div class="css-1lyp5n8">And we can see our shutdown script has done it's job:</div><img class="css-1stgykt" src="/static/media/s3_with_proof.016808eb.png"><div class="css-iyq5fi"><h4 class="css-yz2fnm">Conclusion</h4></div><div class="css-1lyp5n8">My kids have no idea how good they have it.</div><br><div class="css-1lyp5n8">I hope this post helps someone else look good in front of their kids or at the very least their boss.</div><br><div class="css-1lyp5n8">I think this example does a pretty good job of touching on a lot of key concepts you will encounter in the real world and shows how you can take advantage of some of the key benefits of the cloud:</div><ul style="list-style-type:square"><div class="css-1f4itik"><span style="padding-left:0"><li>Automated deployment using infrastructure as code</li><li>Only paying for resources when you actually need them</li></span></div></ul><br></div></div></div><div>Error: Failed to fetch</div></div></div></div><script>!function(a){function r(r){for(var t,c,_=r[0],n=r[1],i=r[2],l=0,o=[];l<_.length;l++)c=_[l],Object.prototype.hasOwnProperty.call(g,c)&&g[c]&&o.push(g[c][0]),g[c]=0;for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(a[t]=n[t]);for(s&&s(r);o.length;)o.shift()();return h.push.apply(h,i||[]),e()}function e(){for(var a,r=0;r<h.length;r++){for(var e=h[r],t=!0,_=1;_<e.length;_++){var n=e[_];0!==g[n]&&(t=!1)}t&&(h.splice(r--,1),a=c(c.s=e[0]))}return a}var t={},g={152:0},h=[];function c(r){if(t[r])return t[r].exports;var e=t[r]={i:r,l:!1,exports:{}};return a[r].call(e.exports,e,e.exports,c),e.l=!0,e.exports}c.e=function(a){var r=[],e=g[a];if(0!==e)if(e)r.push(e[2]);else{var t=new Promise((function(r,t){e=g[a]=[r,t]}));r.push(e[2]=t);var h,_=document.createElement("script");_.charset="utf-8",_.timeout=120,c.nc&&_.setAttribute("nonce",c.nc),_.src=function(a){return c.p+"static/js/"+({1:"react-syntax-highlighter_languages_refractor_abap",2:"react-syntax-highlighter_languages_refractor_actionscript",3:"react-syntax-highlighter_languages_refractor_ada",4:"react-syntax-highlighter_languages_refractor_apacheconf",5:"react-syntax-highlighter_languages_refractor_apl",6:"react-syntax-highlighter_languages_refractor_applescript",7:"react-syntax-highlighter_languages_refractor_arduino",8:"react-syntax-highlighter_languages_refractor_arff",9:"react-syntax-highlighter_languages_refractor_asciidoc",10:"react-syntax-highlighter_languages_refractor_asm6502",11:"react-syntax-highlighter_languages_refractor_aspnet",12:"react-syntax-highlighter_languages_refractor_autohotkey",13:"react-syntax-highlighter_languages_refractor_autoit",14:"react-syntax-highlighter_languages_refractor_bash",15:"react-syntax-highlighter_languages_refractor_basic",16:"react-syntax-highlighter_languages_refractor_batch",17:"react-syntax-highlighter_languages_refractor_bison",18:"react-syntax-highlighter_languages_refractor_brainfuck",19:"react-syntax-highlighter_languages_refractor_bro",20:"react-syntax-highlighter_languages_refractor_c",21:"react-syntax-highlighter_languages_refractor_clike",22:"react-syntax-highlighter_languages_refractor_clojure",23:"react-syntax-highlighter_languages_refractor_coffeescript",24:"react-syntax-highlighter_languages_refractor_cpp",25:"react-syntax-highlighter_languages_refractor_crystal",26:"react-syntax-highlighter_languages_refractor_csharp",27:"react-syntax-highlighter_languages_refractor_csp",28:"react-syntax-highlighter_languages_refractor_css",29:"react-syntax-highlighter_languages_refractor_cssExtras",30:"react-syntax-highlighter_languages_refractor_d",31:"react-syntax-highlighter_languages_refractor_dart",32:"react-syntax-highlighter_languages_refractor_diff",33:"react-syntax-highlighter_languages_refractor_django",34:"react-syntax-highlighter_languages_refractor_docker",35:"react-syntax-highlighter_languages_refractor_eiffel",36:"react-syntax-highlighter_languages_refractor_elixir",37:"react-syntax-highlighter_languages_refractor_elm",38:"react-syntax-highlighter_languages_refractor_erb",39:"react-syntax-highlighter_languages_refractor_erlang",40:"react-syntax-highlighter_languages_refractor_flow",41:"react-syntax-highlighter_languages_refractor_fortran",42:"react-syntax-highlighter_languages_refractor_fsharp",43:"react-syntax-highlighter_languages_refractor_gedcom",44:"react-syntax-highlighter_languages_refractor_gherkin",45:"react-syntax-highlighter_languages_refractor_git",46:"react-syntax-highlighter_languages_refractor_glsl",47:"react-syntax-highlighter_languages_refractor_go",48:"react-syntax-highlighter_languages_refractor_graphql",49:"react-syntax-highlighter_languages_refractor_groovy",50:"react-syntax-highlighter_languages_refractor_haml",51:"react-syntax-highlighter_languages_refractor_handlebars",52:"react-syntax-highlighter_languages_refractor_haskell",53:"react-syntax-highlighter_languages_refractor_haxe",54:"react-syntax-highlighter_languages_refractor_hpkp",55:"react-syntax-highlighter_languages_refractor_hsts",56:"react-syntax-highlighter_languages_refractor_http",57:"react-syntax-highlighter_languages_refractor_ichigojam",58:"react-syntax-highlighter_languages_refractor_icon",59:"react-syntax-highlighter_languages_refractor_inform7",60:"react-syntax-highlighter_languages_refractor_ini",61:"react-syntax-highlighter_languages_refractor_io",62:"react-syntax-highlighter_languages_refractor_j",63:"react-syntax-highlighter_languages_refractor_java",64:"react-syntax-highlighter_languages_refractor_javascript",65:"react-syntax-highlighter_languages_refractor_jolie",66:"react-syntax-highlighter_languages_refractor_json",67:"react-syntax-highlighter_languages_refractor_jsx",68:"react-syntax-highlighter_languages_refractor_julia",69:"react-syntax-highlighter_languages_refractor_keyman",70:"react-syntax-highlighter_languages_refractor_kotlin",71:"react-syntax-highlighter_languages_refractor_latex",72:"react-syntax-highlighter_languages_refractor_less",73:"react-syntax-highlighter_languages_refractor_liquid",74:"react-syntax-highlighter_languages_refractor_lisp",75:"react-syntax-highlighter_languages_refractor_livescript",76:"react-syntax-highlighter_languages_refractor_lolcode",77:"react-syntax-highlighter_languages_refractor_lua",78:"react-syntax-highlighter_languages_refractor_makefile",79:"react-syntax-highlighter_languages_refractor_markdown",80:"react-syntax-highlighter_languages_refractor_markup",81:"react-syntax-highlighter_languages_refractor_markupTemplating",82:"react-syntax-highlighter_languages_refractor_matlab",83:"react-syntax-highlighter_languages_refractor_mel",84:"react-syntax-highlighter_languages_refractor_mizar",85:"react-syntax-highlighter_languages_refractor_monkey",86:"react-syntax-highlighter_languages_refractor_n4js",87:"react-syntax-highlighter_languages_refractor_nasm",88:"react-syntax-highlighter_languages_refractor_nginx",89:"react-syntax-highlighter_languages_refractor_nim",90:"react-syntax-highlighter_languages_refractor_nix",91:"react-syntax-highlighter_languages_refractor_nsis",92:"react-syntax-highlighter_languages_refractor_objectivec",93:"react-syntax-highlighter_languages_refractor_ocaml",94:"react-syntax-highlighter_languages_refractor_opencl",95:"react-syntax-highlighter_languages_refractor_oz",96:"react-syntax-highlighter_languages_refractor_parigp",97:"react-syntax-highlighter_languages_refractor_parser",98:"react-syntax-highlighter_languages_refractor_pascal",99:"react-syntax-highlighter_languages_refractor_perl",100:"react-syntax-highlighter_languages_refractor_php",101:"react-syntax-highlighter_languages_refractor_phpExtras",102:"react-syntax-highlighter_languages_refractor_plsql",103:"react-syntax-highlighter_languages_refractor_powershell",104:"react-syntax-highlighter_languages_refractor_processing",105:"react-syntax-highlighter_languages_refractor_prolog",106:"react-syntax-highlighter_languages_refractor_properties",107:"react-syntax-highlighter_languages_refractor_protobuf",108:"react-syntax-highlighter_languages_refractor_pug",109:"react-syntax-highlighter_languages_refractor_puppet",110:"react-syntax-highlighter_languages_refractor_pure",111:"react-syntax-highlighter_languages_refractor_python",112:"react-syntax-highlighter_languages_refractor_q",113:"react-syntax-highlighter_languages_refractor_qore",114:"react-syntax-highlighter_languages_refractor_r",115:"react-syntax-highlighter_languages_refractor_reason",116:"react-syntax-highlighter_languages_refractor_renpy",117:"react-syntax-highlighter_languages_refractor_rest",118:"react-syntax-highlighter_languages_refractor_rip",119:"react-syntax-highlighter_languages_refractor_roboconf",120:"react-syntax-highlighter_languages_refractor_ruby",121:"react-syntax-highlighter_languages_refractor_rust",122:"react-syntax-highlighter_languages_refractor_sas",123:"react-syntax-highlighter_languages_refractor_sass",124:"react-syntax-highlighter_languages_refractor_scala",125:"react-syntax-highlighter_languages_refractor_scheme",126:"react-syntax-highlighter_languages_refractor_scss",127:"react-syntax-highlighter_languages_refractor_smalltalk",128:"react-syntax-highlighter_languages_refractor_smarty",129:"react-syntax-highlighter_languages_refractor_soy",130:"react-syntax-highlighter_languages_refractor_sql",131:"react-syntax-highlighter_languages_refractor_stylus",132:"react-syntax-highlighter_languages_refractor_swift",133:"react-syntax-highlighter_languages_refractor_tap",134:"react-syntax-highlighter_languages_refractor_tcl",135:"react-syntax-highlighter_languages_refractor_textile",136:"react-syntax-highlighter_languages_refractor_tsx",137:"react-syntax-highlighter_languages_refractor_tt2",138:"react-syntax-highlighter_languages_refractor_twig",139:"react-syntax-highlighter_languages_refractor_typescript",140:"react-syntax-highlighter_languages_refractor_vbnet",141:"react-syntax-highlighter_languages_refractor_velocity",142:"react-syntax-highlighter_languages_refractor_verilog",143:"react-syntax-highlighter_languages_refractor_vhdl",144:"react-syntax-highlighter_languages_refractor_vim",145:"react-syntax-highlighter_languages_refractor_visualBasic",146:"react-syntax-highlighter_languages_refractor_wasm",147:"react-syntax-highlighter_languages_refractor_wiki",148:"react-syntax-highlighter_languages_refractor_xeora",149:"react-syntax-highlighter_languages_refractor_xojo",150:"react-syntax-highlighter_languages_refractor_xquery",151:"react-syntax-highlighter_languages_refractor_yaml"}[a]||a)+"."+{1:"5ce0a218",2:"c91906ac",3:"adb19a44",4:"cc59464f",5:"f8993fd3",6:"66911c33",7:"5678a631",8:"d949ca17",9:"11560d88",10:"4e2e0fa1",11:"834e2292",12:"2ce03349",13:"0a73301c",14:"e194bbbb",15:"f026f83e",16:"2510a051",17:"3025470a",18:"83c4b6a1",19:"625bc7e9",20:"425910a3",21:"0955efde",22:"49466316",23:"1e18b429",24:"89a4c21a",25:"97091f1c",26:"fb21a125",27:"efcc5dec",28:"798fc99c",29:"a64f1295",30:"2ad7f268",31:"752a7496",32:"ce8cb85b",33:"f252dd21",34:"e5a0a512",35:"4a522aed",36:"583b5291",37:"41627fdd",38:"a60636d5",39:"7d2b660e",40:"9f9caa05",41:"33e0a0be",42:"7ad17005",43:"3dd1d2cc",44:"af660035",45:"9bbd406f",46:"f33a63fe",47:"a527f8cd",48:"78ecb5b0",49:"fa62ae82",50:"bcab50bd",51:"68786be8",52:"0fc354df",53:"7b33298d",54:"5389b745",55:"b6b2694f",56:"e69823e4",57:"e9fffe32",58:"29b25347",59:"9ecb9913",60:"3019a210",61:"1c1966ce",62:"b0f01e61",63:"b668e591",64:"ae7fe12c",65:"fba34806",66:"4e8e5b51",67:"afd8d23f",68:"e9bc2e28",69:"e1b48b11",70:"71e13449",71:"ed9bd742",72:"d63c29a7",73:"ec563105",74:"be07d8f7",75:"c45c435f",76:"eec3a11a",77:"c71772c6",78:"83403a42",79:"39fb8379",80:"5c2cc6db",81:"54a1b646",82:"5dd28799",83:"3d6f1c42",84:"c07eea11",85:"132da623",86:"4d8dcfe2",87:"90a2605d",88:"b06436d9",89:"c15e7982",90:"13c30075",91:"c5451263",92:"82528a50",93:"b29b2026",94:"6f6bdd6b",95:"8e8a5aee",96:"ff046490",97:"014571a1",98:"5d510ebc",99:"28d00c1e",100:"10e5a5e8",101:"b350c939",102:"0c72bb14",103:"8a37cff1",104:"31f0e00c",105:"11333ac6",106:"cfcd1faf",107:"0dd25f3d",108:"636e0118",109:"f1d8d625",110:"21f631b6",111:"b5d4777f",112:"c4cd0a66",113:"c098c4a9",114:"1676e00f",115:"e3116b4b",116:"75af7e7f",117:"e3ebfa0b",118:"df0c16e9",119:"d0d38da4",120:"db9cbd2b",121:"1ed3e15e",122:"7de42bad",123:"dda9ddd6",124:"c9201289",125:"8469f737",126:"a3728a0d",127:"4f072bc0",128:"35b326fb",129:"efd892a8",130:"2e9f1735",131:"b4f7d9a6",132:"0177a5f0",133:"aee746a2",134:"cdb64fd8",135:"e3087533",136:"a2157c33",137:"6511895c",138:"214f604f",139:"cfd6aa4b",140:"14ec90ac",141:"b6a54011",142:"940c431c",143:"bc223863",144:"69f5b598",145:"e11aa54e",146:"724f305c",147:"f0739ea2",148:"221a4511",149:"b9295dfa",150:"b70d910a",151:"aaa07edf",154:"730b755d",155:"2b1e9348",156:"1326124f",157:"db2df864",158:"5a401d60",159:"a6b932ab",160:"b424bf2f",161:"9ae70339"}[a]+".chunk.js"}(a);var n=new Error;h=function(r){_.onerror=_.onload=null,clearTimeout(i);var e=g[a];if(0!==e){if(e){var t=r&&("load"===r.type?"missing":r.type),h=r&&r.target&&r.target.src;n.message="Loading chunk "+a+" failed.\n("+t+": "+h+")",n.name="ChunkLoadError",n.type=t,n.request=h,e[1](n)}g[a]=void 0}};var i=setTimeout((function(){h({type:"timeout",target:_})}),12e4);_.onerror=_.onload=h,document.head.appendChild(_)}return Promise.all(r)},c.m=a,c.c=t,c.d=function(a,r,e){c.o(a,r)||Object.defineProperty(a,r,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,r){if(1&r&&(a=c(a)),8&r)return a;if(4&r&&"object"==typeof a&&a&&a.__esModule)return a;var e=Object.create(null);if(c.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:a}),2&r&&"string"!=typeof a)for(var t in a)c.d(e,t,function(r){return a[r]}.bind(null,t));return e},c.n=function(a){var r=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(r,"a",r),r},c.o=function(a,r){return Object.prototype.hasOwnProperty.call(a,r)},c.p="/",c.oe=function(a){throw console.error(a),a};var _=this["webpackJsonpblog-site"]=this["webpackJsonpblog-site"]||[],n=_.push.bind(_);_.push=r,_=_.slice();for(var i=0;i<_.length;i++)r(_[i]);var s=n;e()}([])</script><script src="/static/js/153.2eb38fd0.chunk.js"></script><script src="/static/js/main.59b35fd3.chunk.js"></script></body></html>